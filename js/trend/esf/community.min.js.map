{"version":3,"sources":["trend/esf/community.min.js"],"names":["communityController","echartsData","$","attr","echartFun","recombineM","JSON","parse","that","hide","require","listSearch","init","selectFun","Location","businessType","cityApiUrl","apiUrl","common","getCityByLatLon","identical","position","investmentFlag","Flag","investment","show","echartData","seriesData","countNum","echartShow","forEach","item","index","push","parseFloat","sortArray","sort","a","b","maxPrice","Math","ceil","length","notZroArray","minPrice","avgPrice","myChart","echarts","document","getElementById","width","option","tooltip","trigger","triggerOn","backgroundColor","padding","textStyle","color","fontSize","formatter","params","ticket","callback","paramsValue","value","request","bigData","echartBigData","grid","bottom","left","right","containLabel","xAxis","data","monthList","splitLine","axisTick","type","boundaryGap","axisLine","lineStyle","axisLabel","interval","rotate","fontFamily","yAxis","inside","toFixed","min","max","series","name","normal","itemStyle","emphasis","borderColor","borderWidth","symbolSize","connectNulls","setOption","month","date","split","indexOf","charAt","unitPrice","Controller","ready"],"mappings":"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","file":"community.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n 1. 项目名称：悟空找房h5\r\n 2. 页面名称：trend/esf/community(二手房价格行情 小区)\r\n 3. 作者：liyang@lifang.com\r\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\nclass communityController extends Controller {\r\n    constructor() {\r\n        super();\r\n        let echartsData =  $('.echart').attr('data-echart');\r\n        if (echartsData){\r\n            this.echartFun(this.recombineM(JSON.parse(echartsData))) ;\r\n        }\r\n        let that = this;\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n       房源的展示控制\r\n       -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        $('.flag>a.esf-item:gt(4)').hide();\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        搜索框的点击：\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        require(['../../components/trend-search.min'],function(listSearch){\r\n            listSearch.init(that);\r\n            listSearch.selectFun(\"icon-search\");\r\n        });\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        定位的一个实例\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        new Location({\r\n            businessType : \"esfTrend\" ,\r\n            cityApiUrl : this.apiUrl.common.getCityByLatLon ,\r\n            identical : (position)=> {\r\n\r\n            },\r\n            investmentFlag:(Flag)=>{\r\n                if (Flag.investment){\r\n                    $('notopen-investment').show();\r\n                }else {\r\n                    $('notopen-investment').hide();\r\n                }\r\n            }\r\n        }) ;\r\n    }\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    折线图函数异步操作\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    echartFun(echartData){\r\n\r\n        let seriesData=[];\r\n        let countNum = 0;\r\n        let echartShow = true;\r\n        echartData.seriesData.forEach(function(item,index){\r\n            if(item == 0){\r\n                seriesData.push(null);\r\n                countNum += 1;\r\n                if (countNum == 11 && index == 10){\r\n                    echartShow = false;\r\n                }\r\n            }else{\r\n                seriesData.push(parseFloat(item));\r\n            }\r\n        });\r\n        if (!echartShow) {\r\n            $('#estateEchart').hide();\r\n            return\r\n        }\r\n        let sortArray = echartData.seriesData.sort(function(a, b) {\r\n            return parseFloat(a) - parseFloat(b);\r\n        });\r\n        let maxPrice = Math.ceil((sortArray[sortArray.length - 1] / 1000)) * 1000;\r\n        let notZroArray = [];\r\n        sortArray.forEach(function (item,index) {\r\n            if (item != 0){\r\n                notZroArray.push(item)\r\n            }\r\n        });\r\n        let minPrice = Math.ceil((notZroArray[0] / 1000) - 1) * 1000;\r\n        let avgPrice = 1000 ;\r\n        if (sortArray[sortArray.length - 1] == notZroArray[0] ) {\r\n            minPrice = minPrice - 2000;\r\n            avgPrice = 1000\r\n        }else{\r\n            avgPrice = (maxPrice - minPrice)/4 < 1000 ? 1000:Math.ceil((maxPrice - minPrice)/4000)*1000;\r\n        }\r\n        minPrice =  minPrice < 0 ? 0:minPrice;\r\n        let myChart = echarts.init(document.getElementById('main'),{ width: '92%' });\r\n        let that = this;\r\n        // 指定图表的配置项和数据\r\n        let option = {\r\n            tooltip: {      // 提示框\r\n                trigger: 'item',\r\n                triggerOn: 'click',\r\n                position: 'top',\r\n                backgroundColor: '#4081D6',\r\n                padding: 4,\r\n                textStyle: {\r\n                    color: '#fff',\r\n                    fontSize: '12'\r\n                },\r\n                formatter:function (params, ticket, callback) {\r\n                    let paramsValue =  params.value + \"元\";\r\n                    that.request(that.apiUrl.common.bigData , echartBigData ,function () {\r\n\r\n                    });\r\n                    return paramsValue;\r\n                }\r\n            },\r\n            grid: {\r\n                bottom: 20,\r\n                left: '3%',\r\n                right: '10%',\r\n                containLabel: true,\r\n            },\r\n            xAxis: {\r\n                data: echartData.monthList ,  // X坐标数据\r\n                splitLine: {show: false}, // 控制网格线是否显示\r\n                axisTick: {show: false},  // 去除x轴上的刻度线\r\n                position: 'bottom',\r\n                type: 'category',\r\n                boundaryGap: false,\r\n                axisLine: {\r\n                    lineStyle: {\r\n                        color: '#979797', // x轴颜色\r\n                    }\r\n                },\r\n                axisLabel: {\r\n                    interval: 0,\r\n                    rotate: 0, //60度角倾斜显示\r\n                    textStyle: {\r\n                        color: '#999',\r\n                        fontSize: 12,\r\n                        fontFamily: '微软雅黑'\r\n                    }\r\n                },\r\n            },\r\n            yAxis: {\r\n                axisLine: {show: false},   // y轴是否显示\r\n                splitLine: {\r\n                    show: true,  // 控制网格线是否显示\r\n                    lineStyle: {\r\n                        color: ['#979797'] // y刻度颜色\r\n                    }\r\n                },\r\n                axisTick: {show: false},// 去除y轴上的刻度线\r\n                axisLabel:{\r\n                    inside: false,\r\n                    textStyle: {\r\n                        color: '#999',\r\n                    },\r\n                    formatter: function(value, index) {\r\n                        if (value == minPrice-avgPrice || value == 0) {\r\n                            return \"\";\r\n                        } else {\r\n                            return (value / 10000).toFixed(1) + ' 万';\r\n                        }\r\n                    }\r\n                },\r\n                boundaryGap : false,\r\n                position:'right',\r\n                min:minPrice-avgPrice > 0 ? minPrice-avgPrice : 0,\r\n                max:minPrice-avgPrice > 0 ? minPrice+ avgPrice * 4:avgPrice * 5,\r\n                interval:avgPrice,\r\n            },\r\n            series: [{\r\n                name: '销量',\r\n                type: 'line',\r\n                lineStyle:{\r\n                    normal:{\r\n                        color:'#4081D6', // 折线条颜色\r\n                    }\r\n\r\n                },\r\n                itemStyle:{\r\n                    normal:{\r\n                        color: \"#4081D6\", //图标颜色\r\n                    },\r\n                    emphasis: { //重点，强调时候的样式，即当鼠标悬停或点击上去的时候的拐点的样式\r\n                        borderColor: '#4081D6',\r\n                        borderWidth: 2,\r\n                        color: '#4081D6'\r\n                    }\r\n                },\r\n                symbolSize: 5,\r\n                connectNulls: true,\r\n                data: seriesData,\r\n            }],\r\n        };\r\n        myChart.setOption(option);\r\n    };\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    处理得到的数据的函数  处理月份和数据\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    recombineM(data) {\r\n        let echartData = {\r\n            monthList: [],\r\n            seriesData: []\r\n        };\r\n        if (data) {\r\n            data.forEach((item,index) => {\r\n                let month = item.date.split('-')[1];\r\n                if (month.indexOf('0') == 0) {\r\n                    echartData.monthList.push(month.charAt(1))\r\n                } else {\r\n                    echartData.monthList.push(month)\r\n                }\r\n                echartData.seriesData.push(item.unitPrice)\r\n            });\r\n        }\r\n        echartData.monthList[11]= \"     \"+echartData.monthList[11]+\"   (月)\";\r\n        return echartData ;\r\n    }\r\n}\r\n/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n类的初始化\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n$(document).ready(function() {\r\n    new communityController;\r\n});"]}
{"version":3,"sources":["trend/esf/city.min.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","cityController","_Controller","this","_this","getPrototypeOf","echartsData","$","attr","echartFun","recombineM","JSON","parse","that","click","html","show","hide","require","listSearch","init","selectFun","Location","businessType","cityApiUrl","apiUrl","common","getCityByLatLon","identical","position","investmentFlag","Flag","investment","BigData","bigData","pageName","type","echartData","seriesData","countNum","echartShow","forEach","item","index","push","parseFloat","sortArray","sort","a","b","maxPrice","Math","ceil","notZroArray","minPrice","avgPrice","myChart","echarts","document","getElementById","width","option","tooltip","trigger","triggerOn","backgroundColor","padding","textStyle","color","fontSize","formatter","params","ticket","callback","paramsValue","grid","bottom","left","right","containLabel","xAxis","data","monthList","splitLine","axisTick","boundaryGap","axisLine","lineStyle","axisLabel","interval","rotate","fontFamily","yAxis","onZero","inside","toFixed","min","max","series","name","normal","itemStyle","borderWidth","emphasis","borderColor","areaStyle","graphic","LinearGradient","offset","symbolSize","connectNulls","setOption","month","date","split","indexOf","charAt","unitPrice","Controller","ready"],"mappings":"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","file":"city.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n 1. 项目名称：悟空找房h5\r\n 2. 页面名称：trend/esf/city(二手房价格行情 城市)\r\n 3. 作者：liyang@lifang.com\r\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\nclass cityController extends Controller {\r\n    constructor() {\r\n        super();\r\n         let echartsData =  $('.echart').attr('data-echart');\r\n        if (echartsData){\r\n            this.echartFun(this.recombineM(JSON.parse(echartsData))) ;\r\n        }\r\n        let that = this;\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n       区域的加载更多和收起\r\n       -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        $('#districtMore').click(function () {\r\n            if ($(this).html() ==\"加载全部\") {\r\n                $('.district > ul >li:gt(5)').show();\r\n                $(this).html(\"收起\")\r\n            }else {\r\n                $(this).html(\"加载全部\");\r\n                $('.district > ul >li:gt(5)').hide();\r\n            }\r\n        });\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        搜索框的点击：\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        require(['../../components/trend-search.min'],function(listSearch){\r\n            listSearch.init(that);\r\n            listSearch.selectFun(\"icon-search\");\r\n        });\r\n\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        定位的一个实例\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        new Location({\r\n            businessType : \"esfTrend\" ,\r\n            cityApiUrl : this.apiUrl.common.getCityByLatLon ,\r\n            identical : (position)=> {\r\n\r\n            },\r\n            investmentFlag:(Flag)=>{\r\n                if (Flag.investment){\r\n                    $('notopen-investment').show();\r\n                }else {\r\n                    $('notopen-investment').hide();\r\n                }\r\n            }\r\n        }) ;\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        页面埋点\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        require(['../../components/bigdata.min'],function(BigData){\r\n            BigData.init(that);\r\n            BigData.bigData({\r\n                \"pageName\": \"1112\",\r\n                \"type\": 1\r\n            });\r\n        });\r\n    }\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    折线图函数异步操作\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    echartFun(echartData){\r\n\r\n        let seriesData=[];\r\n        let countNum = 0;\r\n        let echartShow = true;\r\n        echartData.seriesData.forEach(function(item,index){\r\n            if(item == 0){\r\n                seriesData.push(null);\r\n                countNum += 1;\r\n                if (countNum == 11 && index == 10){\r\n                    echartShow = false;\r\n                }\r\n            }else{\r\n                seriesData.push(parseFloat(item));\r\n            }\r\n        });\r\n        if (!echartShow) {\r\n            $('#estateEchart').hide();\r\n            return\r\n        }\r\n        let sortArray = echartData.seriesData.sort(function(a, b) {\r\n            return parseFloat(a) - parseFloat(b);\r\n        });\r\n        let maxPrice = Math.ceil((sortArray[sortArray.length - 1] / 1000)) * 1000;\r\n        let notZroArray = [];\r\n        sortArray.forEach(function (item,index) {\r\n                if (item != 0){\r\n                    notZroArray.push(item)\r\n                }\r\n        });\r\n        let minPrice = Math.ceil((notZroArray[0] / 1000) - 1) * 1000;\r\n        let avgPrice = 1000 ;\r\n        if (sortArray[sortArray.length - 1] == notZroArray[0] ) {\r\n            minPrice = minPrice - 2000;\r\n            avgPrice = 1000\r\n        }else{\r\n            avgPrice = (maxPrice - minPrice)/4 < 1000 ? 1000:Math.ceil((maxPrice - minPrice)/4000)*1000;\r\n        }\r\n        minPrice =  minPrice < 0 ? 0:minPrice;\r\n        let myChart = echarts.init(document.getElementById('main'),{ width: '92%' });\r\n        let that = this;\r\n        // 指定图表的配置项和数据\r\n        let option = {\r\n            tooltip: {      // 提示框\r\n                trigger: 'item',\r\n                triggerOn: 'click',\r\n                position: 'top',\r\n                backgroundColor: '#4081D6',\r\n                padding: 4,\r\n                textStyle: {\r\n                    color: '#fff',\r\n                    fontSize: '12'\r\n                },\r\n                formatter:function (params, ticket, callback) {\r\n                    let paramsValue =  params.value + \"元\";\r\n                    return paramsValue;\r\n                }\r\n            },\r\n            grid: {\r\n                bottom: 20,\r\n                left: '3%',\r\n                right: '10%',\r\n                containLabel: true,\r\n            },\r\n            xAxis: {\r\n                data: echartData.monthList ,  // X坐标数据\r\n                splitLine: {show: false}, // 控制网格线是否显示\r\n                axisTick: {show: false},  // 去除x轴上的刻度线\r\n                position: 'bottom',\r\n                type: 'category',\r\n                boundaryGap: false,\r\n                axisLine: {\r\n                    lineStyle: {\r\n                        color: '#fff', // x轴颜色\r\n                    },\r\n                },\r\n                axisLabel: {\r\n                    interval: 0,\r\n                    rotate: 0, //60度角倾斜显示\r\n                    textStyle: {\r\n                        color: '#999',\r\n                        fontSize: 12,\r\n                        fontFamily: '微软雅黑'\r\n                    }\r\n                },\r\n            },\r\n            yAxis: {\r\n                axisLine: {show: false,onZero: true},   // y轴是否显示\r\n                splitLine: {\r\n                    show: true,  // 控制网格线是否显示\r\n                    lineStyle: {\r\n                        color: ['#979797'], // y刻度颜色\r\n                        type:'dotted'\r\n                    }\r\n                },\r\n                axisTick: {show: false },  // 去除y轴上的刻度线\r\n                axisLabel:{\r\n                    inside: false,\r\n                    textStyle:{\r\n                        color:'#999'\r\n                    } ,\r\n                    formatter: function(value, index) {\r\n                        if (index == 0) {\r\n                            return \"\";\r\n                        } else {\r\n                            return (value / 10000).toFixed(1) + ' 万';\r\n                        }\r\n                    }\r\n                },\r\n                boundaryGap : false,\r\n                position:'right',\r\n                min:minPrice-avgPrice > 0 ? minPrice-avgPrice : 0,\r\n                max:minPrice-avgPrice > 0 ? minPrice+ avgPrice * 4:avgPrice * 5,\r\n                interval:avgPrice,\r\n            },\r\n            series: [{\r\n                name: '销量',\r\n                type: 'line',\r\n                lineStyle:{\r\n                    normal:{\r\n                        color:'#4081D6', // 折线条颜色\r\n                        width:3\r\n                    }\r\n\r\n                },\r\n                itemStyle:{\r\n                    normal:{\r\n                        color: \"#4081D6\", //图标颜色\r\n                        borderWidth:2\r\n                    },\r\n                    emphasis: { //重点，强调时候的样式，即当鼠标悬停或点击上去的时候的拐点的样式\r\n                        borderColor: '#4081D6',\r\n                        borderWidth: 2,\r\n                        color: '#4081D6'\r\n                    }\r\n                },\r\n                areaStyle:{ //区域填充样式\r\n                    normal:{\r\n                        //线性渐变\r\n                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                            offset: 1, color: 'rgba(64,129,214,0.15)'  // 0% 处的颜色'#b1e3fe'\r\n                        }, {\r\n                            offset: 1, color: '#fff' // 100% 处的颜色\r\n                        }], false)\r\n                    }\r\n                },\r\n                symbolSize: 10,\r\n                connectNulls: true,\r\n                data: seriesData,\r\n            }],\r\n        };\r\n        myChart.setOption(option);\r\n    };\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    处理得到的数据的函数  处理月份和数据\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    recombineM(data) {\r\n        let echartData = {\r\n            monthList: [],\r\n            seriesData: []\r\n        };\r\n        if (data) {\r\n            data.forEach((item,index) => {\r\n                let month = item.date.split('-')[1];\r\n                if (month.indexOf('0') == 0) {\r\n                    echartData.monthList.push(month.charAt(1))\r\n                }  else  {\r\n                    echartData.monthList.push(month)\r\n                }\r\n                echartData.seriesData.push(item.unitPrice)\r\n            });\r\n        }\r\n        echartData.monthList[11]= \"     \"+echartData.monthList[11]+\"   (月)\";\r\n        return echartData ;\r\n    }\r\n}\r\n/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n类的初始化\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n$(document).ready(function() {\r\n    new cityController;\r\n});"]}
{"version":3,"sources":["components/trend-search.min.js"],"names":["define","that","houseListType","selectFun","select","$","click","show","JSON","parse","localStorage","getItem","searchHistory","reverse","listSearchHistory","bigdata","encodeURIComponent","stringify","eventName","channel","type","forEach","item","index","id","key","address","empty","append","singleData","attr","historyList","hide","val","parent","submit","event","preventDefault","removeItem","on","listData","searchaAcWord","sendData","cityId","cookie","pageName","request","apiUrl","common","acWord","successCallback","data","secondHouseList","titleName","addreName","estateDesc","replace","markname","value","keyCode","saveLocalStorage","splice","length","saveLocal","push","setItem","houseT","cityPinYin","window","location","href","init","c","houseType"],"mappings":"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","file":"trend-search.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n 1. 项目名称：悟空找房h5\r\n 2. 页面名称：components -> trendSearch（搜索框的组件）\r\n 3. 作者：liyang@lifang.com\r\n    参数说明：\r\n    selectName 点击的class\r\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n\r\ndefine(function(){\r\n    let that;\r\n    let houseListType= 'oldhouselist';  // 二手房或者新房来源标识\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    点击icon搜索框的出现\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    let selectFun = function (select) {\r\n        $(`.${select}`).click(function () {\r\n            $('#search').show();\r\n            /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n            // Storage取值渲染搜索历史\r\n            -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n            if (JSON.parse(localStorage.getItem(houseListType)) ) {\r\n                $('.history').show();\r\n                let searchHistory = JSON.parse(localStorage.getItem(houseListType)).reverse();\r\n                let listSearchHistory ='';\r\n                /* 埋点的参数*/\r\n                let bigdata =encodeURIComponent(JSON.stringify({\r\n                    eventName: '1203005',\r\n                    channel:\"channelFlag\" ,\r\n                    type: 2\r\n                }));\r\n                searchHistory.forEach(function (item,index) {\r\n                        listSearchHistory += `<li data-bigdata=\"${bigdata} \" data-type=\"${item.type}\" data-value=\"${item.id}\" data-name=\"${item.key}\" data-address=\"${item.address}\"><p>${item.key}</p><span>${item.address}</span></li>`\r\n                });\r\n                $('#resultHistory').empty().append(listSearchHistory);\r\n                // 历史搜索点击\r\n                $('#resultHistory >li').click(function () {\r\n                    let singleData = {\r\n                        \"key\":$(this).attr('data-name'),\r\n                        \"id\": $(this).attr('data-value'),\r\n                        \"address\": $(this).attr('data-address'),\r\n                        \"type\":$(this).attr('data-type'),\r\n                    };\r\n                    historyList(singleData)\r\n                })\r\n            }else {\r\n                $('.history').hide();\r\n            }\r\n        });\r\n    };\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    点击icon搜索框的隐藏\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    $('.icon-fanhui').click(function () {\r\n        $('#search').hide();\r\n    });\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    点击icon搜索框的清空\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    $('.icon-close').click(function () {\r\n        $('#searchInput').val('');\r\n        $('#showResult').empty().append().parent().hide();\r\n        $(this).hide();\r\n        $('.no-result').hide();\r\n    });\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    阻止表单的默认行为：\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    $('.input-kw-form').submit(function(event){\r\n        event.preventDefault();\r\n    });\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    清楚搜索历史\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    $('#clearHistory').click(function () {\r\n        localStorage.removeItem('searchTrendHistory');\r\n        $('#resultHistory').empty();\r\n        $('.history').hide();\r\n    });\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    联想词的检索\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    $('#searchInput').on('keyup input',function () {\r\n        if ($(this).val()) {\r\n            $('.icon-close').show();\r\n            $('.history').hide();\r\n            let listData; // 搜索联想结果\r\n            let searchaAcWord =''; // 拼装dome节点\r\n            let sendData={\r\n                key:$(this).val(),\r\n                cityId:$.cookie('cityId') || 43,\r\n                pageName: houseListType\r\n            };\r\n            /* 埋点的参数*/\r\n            let bigdata =encodeURIComponent(JSON.stringify({\r\n                eventName: '1203004',\r\n                channel:\"channelFlag\" ,\r\n                type: 2\r\n            }));\r\n            that.request(that.apiUrl.common.acWord,sendData,{successCallback(data){\r\n                      listData = data.data;\r\n                    if (listData.secondHouseList){\r\n                       $('.have-result').show();\r\n                       $('.no-result').hide();\r\n                        let titleName ='';\r\n                        let addreName = '';\r\n                        listData.secondHouseList.forEach(function (item,index) {  // 循环出搜索结果\r\n                            if (item.type == 1 || item.type == 2 || item.type == 5) {\r\n                                titleName = item.estateDesc.replace(item.markname, `<span>${item.markname}</span>`);\r\n                                addreName = item.address.replace(item.markname, `<span>${item.markname}</span>`);\r\n                                searchaAcWord += `<li data-bigdata=\"${bigdata} \" data-type=\"${item.type}\" data-value=\"${item.value}\" data-name=\"${item.estateDesc}\" data-address=\"${item.address}\"><p>${titleName}</p><span>${addreName}</span></li>`\r\n                            }\r\n                        }) ;\r\n                        $('#showResult').empty().append(searchaAcWord);\r\n                    }else {\r\n                        $('#showResult').empty();\r\n                        $('.have-result').hide();\r\n                        $('.history').hide();\r\n                        $('.no-result').show();\r\n                    }\r\n                    $('#showResult > li').click(function () {\r\n                        let singleData = {\r\n                            \"key\":$(this).attr('data-name'),\r\n                            \"id\": $(this).attr('data-value'),\r\n                            \"address\": $(this).attr('data-address'),\r\n                            \"type\":$(this).attr('data-type'),\r\n                        };\r\n                        historyList(singleData)\r\n                    })\r\n                }});\r\n            if (searchaAcWord) { // enter键出发的搜索\r\n                if (event.keyCode == 13) {\r\n                    let singleData = {\r\n                        \"key\": $('#showResult>li:eq(0)').attr('data-name'),\r\n                        \"id\": $('#showResult>li:eq(0)').attr('data-value'),\r\n                        \"address\": $('#showResult>li:eq(0)').attr('data-address'),\r\n                        \"type\": $('#showResult>li:eq(0)').attr('data-type'),\r\n                    };\r\n                    historyList(singleData)\r\n                }\r\n            }\r\n        }else {\r\n            $('#showResult').empty().parent().hide();\r\n            $('.icon-close').hide();\r\n            if (localStorage.getItem(houseListType)){\r\n                $('.history').show();\r\n            }else {\r\n                $('.history').hide();\r\n            }\r\n\r\n        }\r\n    });\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    联想词的检索历史储存到localStorage\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    let historyList = function (singleData) {\r\n       let  saveLocalStorage = JSON.parse(localStorage.getItem(houseListType)) ? JSON.parse(localStorage.getItem(houseListType)) : [];\r\n        saveLocalStorage.forEach(function (item, index) {\r\n            if (item.id == singleData.id && item.type == singleData.type) {\r\n                saveLocalStorage.splice(index, 1)\r\n            }\r\n        });\r\n        if (saveLocalStorage.length > 4) {\r\n            saveLocalStorage.reverse().splice(4)\r\n        }\r\n        let saveLocal = saveLocalStorage.reverse();\r\n        saveLocal.push(singleData);\r\n        localStorage.setItem(houseListType, JSON.stringify(saveLocal));\r\n        let houseT =  houseListType==\"oldhouselist\" ? \"esf\":\"new\";\r\n        let cityPinYin = $.cookie('pinyin');\r\n        if (singleData.type == 1){\r\n            window.location.href = `${cityPinYin}/trend/${houseT}/district/${singleData.id}`\r\n        }else if (singleData.type == 2) {\r\n            /*console.log(`/trend/${houseT}/town/${singleData.id}`);*/\r\n            window.location.href = `${cityPinYin}/trend/${houseT}/town/${singleData.id}`\r\n        }else if (singleData.type == 5) {\r\n           /* console.log(`/trend/${houseT}/community/${singleData.id}`);*/\r\n            window.location.href = `${cityPinYin}/trend/${houseT}/community/${singleData.id}`\r\n        }\r\n    };\r\n    return {\r\n        init: function(c,houseType){\r\n            that = c;\r\n            houseListType = houseType || \"oldhouselist\";\r\n        },\r\n        selectFun : selectFun\r\n    }\r\n});"]}
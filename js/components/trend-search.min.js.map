{"version":3,"sources":["components/trend-search.min.js"],"names":["define","that","houseListType","selectFun","select","$","click","show","JSON","parse","localStorage","getItem","searchHistory","reverse","listSearchHistory","bigdata","encodeURIComponent","stringify","eventName","channel","type","forEach","item","index","id","key","address","empty","append","singleData","attr","historyList","hide","val","parent","submit","event","preventDefault","removeItem","on","listData","searchaAcWord","sendData","cityId","cookie","pageName","request","apiUrl","common","acWord","successCallback","data","secondHouseList","titleName","addreName","estateDesc","replace","markname","value","keyCode","saveLocalStorage","splice","length","saveLocal","push","setItem","houseT","cityPinYin","window","location","href","init","c","houseType"],"mappings":"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","file":"trend-search.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n 1. 项目名称：悟空找房h5\n 2. 页面名称：components -> trendSearch（搜索框的组件）\n 3. 作者：liyang@lifang.com\n    参数说明：\n    selectName 点击的class\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n\ndefine(function(){\n    let that;\n    let houseListType= 'oldhouselist';  // 二手房或者新房来源标识\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    点击icon搜索框的出现\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    let selectFun = function (select) {\n        $(`.${select}`).click(function () {\n            $('#search').show();\n            /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n            // Storage取值渲染搜索历史\n            -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n            if (JSON.parse(localStorage.getItem(houseListType)) ) {\n                $('.history').show();\n                let searchHistory = JSON.parse(localStorage.getItem(houseListType)).reverse();\n                let listSearchHistory ='';\n                /* 埋点的参数*/\n                let bigdata =encodeURIComponent(JSON.stringify({\n                    eventName: '1203005',\n                    channel:\"channelFlag\" ,\n                    type: 2\n                }));\n                searchHistory.forEach(function (item,index) {\n                        listSearchHistory += `<li data-bigdata=\"${bigdata} \" data-type=\"${item.type}\" data-value=\"${item.id}\" data-name=\"${item.key}\" data-address=\"${item.address}\"><p>${item.key}</p><span>${item.address}</span></li>`\n                });\n                $('#resultHistory').empty().append(listSearchHistory);\n                // 历史搜索点击\n                $('#resultHistory >li').click(function () {\n                    let singleData = {\n                        \"key\":$(this).attr('data-name'),\n                        \"id\": $(this).attr('data-value'),\n                        \"address\": $(this).attr('data-address'),\n                        \"type\":$(this).attr('data-type'),\n                    };\n                    historyList(singleData)\n                })\n            }else {\n                $('.history').hide();\n            }\n        });\n    };\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    点击icon搜索框的隐藏\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    $('.icon-fanhui').click(function () {\n        $('#search').hide();\n    });\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    点击icon搜索框的清空\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    $('.icon-close').click(function () {\n        $('#searchInput').val('');\n        $('#showResult').empty().append().parent().hide();\n        $(this).hide();\n        $('.no-result').hide();\n    });\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    阻止表单的默认行为：\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    $('.input-kw-form').submit(function(event){\n        event.preventDefault();\n    });\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    清楚搜索历史\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    $('#clearHistory').click(function () {\n        localStorage.removeItem('searchTrendHistory');\n        $('#resultHistory').empty();\n        $('.history').hide();\n    });\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    联想词的检索\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    $('#searchInput').on('keyup input',function () {\n        if ($(this).val()) {\n            $('.icon-close').show();\n            $('.history').hide();\n            let listData; // 搜索联想结果\n            let searchaAcWord =''; // 拼装dome节点\n            let sendData={\n                key:$(this).val(),\n                cityId:$.cookie('cityId') || 43,\n                pageName: houseListType\n            };\n            /* 埋点的参数*/\n            let bigdata =encodeURIComponent(JSON.stringify({\n                eventName: '1203004',\n                channel:\"channelFlag\" ,\n                type: 2\n            }));\n            that.request(that.apiUrl.common.acWord,sendData,{successCallback(data){\n                      listData = data.data;\n                    if (listData.secondHouseList){\n                       $('.have-result').show();\n                       $('.no-result').hide();\n                        let titleName ='';\n                        let addreName = '';\n                        listData.secondHouseList.forEach(function (item,index) {  // 循环出搜索结果\n                            if (item.type == 1 || item.type == 2 || item.type == 5) {\n                                titleName = item.estateDesc.replace(item.markname, `<span>${item.markname}</span>`);\n                                addreName = item.address.replace(item.markname, `<span>${item.markname}</span>`);\n                                searchaAcWord += `<li data-bigdata=\"${bigdata} \" data-type=\"${item.type}\" data-value=\"${item.value}\" data-name=\"${item.estateDesc}\" data-address=\"${item.address}\"><p>${titleName}</p><span>${addreName}</span></li>`\n                            }\n                        }) ;\n                        $('#showResult').empty().append(searchaAcWord);\n                    }else {\n                        $('#showResult').empty();\n                        $('.have-result').hide();\n                        $('.history').hide();\n                        $('.no-result').show();\n                    }\n                    $('#showResult > li').click(function () {\n                        let singleData = {\n                            \"key\":$(this).attr('data-name'),\n                            \"id\": $(this).attr('data-value'),\n                            \"address\": $(this).attr('data-address'),\n                            \"type\":$(this).attr('data-type'),\n                        };\n                        historyList(singleData)\n                    })\n                }});\n            if (searchaAcWord) { // enter键出发的搜索\n                if (event.keyCode == 13) {\n                    let singleData = {\n                        \"key\": $('#showResult>li:eq(0)').attr('data-name'),\n                        \"id\": $('#showResult>li:eq(0)').attr('data-value'),\n                        \"address\": $('#showResult>li:eq(0)').attr('data-address'),\n                        \"type\": $('#showResult>li:eq(0)').attr('data-type'),\n                    };\n                    historyList(singleData)\n                }\n            }\n        }else {\n            $('#showResult').empty().parent().hide();\n            $('.icon-close').hide();\n            if (localStorage.getItem(houseListType)){\n                $('.history').show();\n            }else {\n                $('.history').hide();\n            }\n\n        }\n    });\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    联想词的检索历史储存到localStorage\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    let historyList = function (singleData) {\n       let  saveLocalStorage = JSON.parse(localStorage.getItem(houseListType)) ? JSON.parse(localStorage.getItem(houseListType)) : [];\n        saveLocalStorage.forEach(function (item, index) {\n            if (item.id == singleData.id && item.type == singleData.type) {\n                saveLocalStorage.splice(index, 1)\n            }\n        });\n        if (saveLocalStorage.length > 4) {\n            saveLocalStorage.reverse().splice(4)\n        }\n        let saveLocal = saveLocalStorage.reverse();\n        saveLocal.push(singleData);\n        localStorage.setItem(houseListType, JSON.stringify(saveLocal));\n        let houseT =  houseListType==\"oldhouselist\" ? \"esf\":\"new\";\n        let cityPinYin = $.cookie('pinyin');\n        if (singleData.type == 1){\n            window.location.href = `${cityPinYin}/trend/${houseT}/district/${singleData.id}`\n        }else if (singleData.type == 2) {\n            /*console.log(`/trend/${houseT}/town/${singleData.id}`);*/\n            window.location.href = `${cityPinYin}/trend/${houseT}/town/${singleData.id}`\n        }else if (singleData.type == 5) {\n           /* console.log(`/trend/${houseT}/community/${singleData.id}`);*/\n            window.location.href = `${cityPinYin}/trend/${houseT}/community/${singleData.id}`\n        }\n    };\n    return {\n        init: function(c,houseType){\n            that = c;\n            houseListType = houseType || \"oldhouselist\";\n        },\n        selectFun : selectFun\n    }\n});"]}
{"version":3,"sources":["components/webViewBridge.min.js"],"names":["define","isArray","o","Object","prototype","toString","call","connectWebViewJavascriptBridge","callback","window","WebViewJavascriptBridge","document","addEventListener","webViewJavascriptBridge","init","params","bridge","handlers","i","length","tmpHandler","registerHandler","name","data","responseCallback","errorResponseCallback","exception","alert","message","exec","service","action","Error","requestData","undefined","console","log"],"mappings":"AAAA,YAKAA,QAAO,WAuFH,QAASC,GAAQC,GACb,MAA6C,mBAAtCC,OAAOC,UAAUC,SAASC,KAAKJ,GAO1C,QAASK,GAA+BC,GAChCC,OAAOC,wBACPF,EAASE,yBAETC,SAASC,iBACL,+BACA,WACIJ,EAASE,2BAEb,GAnGZ,GAAIG,IACAC,KAAM,SAASC,GACXR,EAA+B,SAASS,GACpC,IASI,GAAID,EAAOE,SACP,GAAIhB,EAAQc,EAAOE,UACf,IAAK,GAAIC,GAAI,EAAGA,EAAIH,EAAOE,SAASE,OAAQD,IAAK,CAC7C,GAAIE,GAAaL,EAAOE,SAASC,EACjCF,GAAOK,gBAAgBD,EAAWE,KAAM,SAASC,EAAMC,EAAkBC,GACjEL,EAAWI,kBACXJ,EAAWI,iBAAiBD,GAG5BH,EAAWK,uBACXL,EAAWK,sBAAsBF,SAK7CP,GAAOK,gBAAgBN,EAAOE,SAASK,KAAM,SAASC,EAAMC,EAAkBC,GACtEV,EAAOE,SAASO,kBAChBT,EAAOE,SAASO,iBAAiBD,GAGjCR,EAAOE,SAASQ,uBAChBV,EAAOE,SAASQ,sBAAsBF,KAKxD,MAAOG,GACLC,MAAMD,EAAUE,aAK5BC,KAAM,SAASd,GACX,IAGI,IAAKA,EAAOe,UAAYf,EAAOgB,OAC3B,KAAM,IAAIC,OAAM,6BAKpB,IAAIF,GAAUf,EAAOe,QACjBC,EAAShB,EAAOgB,OAChBE,EAA6BC,QAAfnB,EAAOQ,QAAyBR,EAAOQ,KACrDC,EAAmBT,EAAOS,iBAC1BC,EAAwBV,EAAOU,qBAGnCf,yBAAwBmB,KAAKC,EAASC,EAAQE,EAAaT,EAAkBC,GAG/E,MAAOC,GAEL,GAAsB,mBAAXS,SAGN,KADDA,SAAQC,IAAI,8DAA+DV,EAAUE,QAASF,GACvFA,IAOnBnB,+BAAgCA,EA4BpC,OAAOM","file":"webViewBridge.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n 1. 项目名称：App内嵌h5\r\n 2. 页面名称：common->webViewJavascriptBridge.js(js与native 交互的js)\r\n 3. 作者：yuxiaochen@lifang.com\r\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\ndefine(function() {\r\n\r\n    /*--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n     定义native 交互交互对象\r\n     --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    var webViewJavascriptBridge = {\r\n        init: function(params) {\r\n            connectWebViewJavascriptBridge(function(bridge) {\r\n                try {\r\n                    //定义默认的native message hanlder\r\n\r\n                    //由于ios没有注册初始message handler 所以此处无法init \r\n                    // bridge.init(function(message, responseCallback, errorResponseCallback) {\r\n                    //     console.log(\"native data: \" + message);\r\n                    // });\r\n\r\n                    //定义 js handlers\r\n                    if (params.handlers) {\r\n                        if (isArray(params.handlers)) {\r\n                            for (var i = 0; i < params.handlers.length; i++) {\r\n                                var tmpHandler = params.handlers[i];\r\n                                bridge.registerHandler(tmpHandler.name, function(data, responseCallback, errorResponseCallback) {\r\n                                    if (tmpHandler.responseCallback) {\r\n                                        tmpHandler.responseCallback(data);\r\n                                    }\r\n\r\n                                    if (tmpHandler.errorResponseCallback) {\r\n                                        tmpHandler.errorResponseCallback(data);\r\n                                    }\r\n                                });\r\n                            }\r\n                        } else {\r\n                            bridge.registerHandler(params.handlers.name, function(data, responseCallback, errorResponseCallback) {\r\n                                if (params.handlers.responseCallback) {\r\n                                    params.handlers.responseCallback(data);\r\n                                }\r\n\r\n                                if (params.handlers.errorResponseCallback) {\r\n                                    params.handlers.errorResponseCallback(data);\r\n                                }\r\n                            });\r\n                        }\r\n                    }\r\n                } catch (exception) {\r\n                    alert(exception.message);\r\n                }\r\n            });\r\n\r\n        },\r\n        exec: function(params) {\r\n            try {\r\n\r\n                //判断必传参数定义是否合法          \r\n                if (!params.service || !params.action) {\r\n                    throw new Error(\"service or action invalid.\");\r\n\r\n                }\r\n\r\n                //定义参数\r\n                var service = params.service;\r\n                var action = params.action;\r\n                var requestData = params.data == undefined ? {} : params.data;\r\n                var responseCallback = params.responseCallback;\r\n                var errorResponseCallback = params.errorResponseCallback;\r\n\r\n                //调用native 方法\r\n                WebViewJavascriptBridge.exec(service, action, requestData, responseCallback, errorResponseCallback);\r\n\r\n\r\n            } catch (exception) {\r\n\r\n                if (typeof console != 'undefined') {\r\n\r\n                    console.log(\"WebViewJavascriptBridge: WARNING: javascript handler threw.\", exception.message, exception);\r\n                     throw exception;\r\n\r\n                }\r\n\r\n            }\r\n\r\n        },\r\n        connectWebViewJavascriptBridge: connectWebViewJavascriptBridge\r\n    };\r\n\r\n    /*--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n     判断是否是一个数组，使用下面的方法也是完全可行的\r\n     --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    function isArray(o) {\r\n        return Object.prototype.toString.call(o) === '[object Array]';\r\n        //return (typeof o == 'object' && o.constructor == Array) ;\r\n    }\r\n\r\n    /*--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n     创建connectWebViewJavascriptBridge 方法\r\n     --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    function connectWebViewJavascriptBridge(callback) {\r\n        if (window.WebViewJavascriptBridge) {\r\n            callback(WebViewJavascriptBridge)\r\n        } else {\r\n            document.addEventListener(\r\n                'WebViewJavascriptBridgeReady',\r\n                function() {\r\n                    callback(WebViewJavascriptBridge)\r\n                },\r\n                false\r\n            );\r\n        }\r\n    }\r\n\r\n    return webViewJavascriptBridge;\r\n})\r\n"]}
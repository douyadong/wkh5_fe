{"version":3,"sources":["components/conning-tower.min.js"],"names":["ConningTower","moduleType","cityClick","$","noop","searchApiUrl","businessCityApiUrl","getCityLolaApiUrl","setCityCache","addEventListener","location","click","slideDown","children","length","request","apiUrl","requestData","success","result","cities","filterBusinessCity","data","$ul","Object","keys","domestic","overseas","append","$domesticFrame","document","createElement","addClass","key","forEach","city","cityId","pinyin","cityType","cityName","$overseasFrame","citySelectorEventDelegate","body","css","fadeIn","animate","right","fadeOut","history","back","show","hide","val","empty","nativeSchema","loadSchema","schema","protocal","loadWaiting","failUrl","apkInfo","PKG","CATEGORY","ACTION","$input","keyup","trim","ajax","url","dataType","error","e","tips","status","toString","message","name","self","frameMarginTop","is","eq","$tabsHandles","removeClass","text","slideUp","typeMapper","typeValue","domesticCityList","has","businessList","business","businessId","shoupin","charAt","toUpperCase","hasOwnProperty","push","overseaCityList","navigator","geolocation","geoOpts","enableHighAccuracy","maximumAge","timeout","getCurrentPosition","position","latitude","coords","longitude","cookie","path","code","PERMISSION_DENIED","locationFail","POSITION_UNAVAILABLE","locationTimeout","TIMEOUT","UNKNOWN_ERROR"],"mappings":"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","file":"conning-tower.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n 1. 项目名称：悟空找房h5\n 2. 页面名称：components -> conning-tower(列表页司令塔，包括返回、搜索、汉堡菜单等信息)\n 3. 作者：zhaohuagang@lifang.com\n 4. 备注：\n    这里面定位需要用到的几个缓存key及缓存类型：\n    1). selectedCityId , selectedCityName , selectedCityPinyin，表示用户选择的城市  使用cookie，司令塔上搜索框旁边的位置显示的就是这个缓存，最终列表数据呈现\n        也是用这套值\n    2). locationCityId , locationCityName , locationCityPinyin , locationLongitude , locationLatitude，表示定位到的城市及经纬度  使用localStorage，因为会话\n        结束后这个定位信息用处就不大了\n    3). deniedPermission : 用户是否阻止过定位授权\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n class ConningTower {\n     constructor({ moduleType , cityClick = $.noop }) {\n         this.moduleType = moduleType ;  //模块类型，可以是：xf | esf | rent\n         /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        几个api地址的配置\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/       \n         this.searchApiUrl = \"/api/common/acWord\" ;  //搜索用的接口地址\n         this.businessCityApiUrl = \"/api/common/businessCity\" ;  //获取业务开通城市接口地址\n         this.getCityLolaApiUrl = \"/api/common/getCityByLatLon\" ;  //通过经纬度反查城市接口地址         \n         /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        几个接口方法 \n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/ \n         this.cityClick = cityClick ;  //城市选择器中城市点击接口事件\n         /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        为了保证cookie的统一写入口，页面同步渲染的时候将城市信息放到页面隐藏域中，然后由FE来写到 cookie中\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n         this.setCityCache() ;\n         /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        事件绑定\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n         this.addEventListener() ;\n         /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        发起定位\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        this.location() ;\n     }\n     /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    组件相关dom节点事件绑定\n     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n     addEventListener() {\n         /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        点击城市选择入口弹出城市选择器并根据是否有了数据来决定是否需要请求接口渲染\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        $(\".conning-tower dl dt\").click(() => {\n            $(\".city-selector\").slideDown(200) ;\n            if($(\".city-selector .tabs-frame\").children().length) return ;\n             /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n            请求业务城市数据并绘制，绘制完后绑定事件\n            -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n            this.request({ \n                apiUrl : this.businessCityApiUrl , \n                requestData : { } , \n                success : (result) => {                    \n                    let cities = this.filterBusinessCity(result.data) ;  //取出所有满足条件的城市清单                    \n                    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n                    绘制tabs-handle\n                    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n                    let $ul = \"<ul class=\\\"tabs-handle\\\"><li class=\\\"on\\\" data-sign=\\\"domestic\\\">国内</li><li data-sign=\\\"overseas\\\">国际</li></ul>\" ;\n                    if( ! Object.keys(cities.domestic).length || ! Object.keys(cities.overseas).length) {                        \n                        if( Object.keys(cities.domestic).length ) $ul = \"<ul class=\\\"tabs-handle\\\" style=\\\"display : none\\\"><li class=\\\"on\\\" data-sign=\\\"domestic\\\">国内</li><li data-sign=\\\"overseas\\\">国际</li></ul>\" ;\n                        else $ul = \"<ul class=\\\"tabs-handle\\\" style=\\\"display : none\\\"><li data-sign=\\\"domestic\\\">国内</li><li class=\\\"on\\\" data-sign=\\\"overseas\\\">国际</li></ul>\" ;\n                    }                   \n                    $(\".city-selector .caption\").append($ul) ;\n                    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n                    绘制tabs-frame\n                    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/                    \n                    let $domesticFrame = $(document.createElement(\"DIV\")).addClass(\"tabs-frame domestic\") ;\n                    if( Object.keys(cities.domestic).length ) {\n                        for( let key in cities.domestic ) {\n                            $domesticFrame.append(\"<span>\" + key + \"</span>\") ;\n                            cities.domestic[key].forEach((city) => {\n                                $domesticFrame.append(\"<a data-cityid=\\\"\" + city.cityId + \"\\\" data-pinyin=\\\"\" + city.pinyin + \"\\\" data-cityType=\\\"\" + city.cityType + \"\\\">\" + city.cityName + \"</a>\") ;\n                            }) ;\n                        }\n                    }\n                    $(\".city-selector\").append($domesticFrame) ;\n\n                    let $overseasFrame = $(document.createElement(\"DIV\")).addClass(\"tabs-frame overseas\") ;\n                    if( Object.keys(cities.overseas).length ) {\n                        for( let key in cities.overseas ) {\n                            $overseasFrame.append(\"<span>\" + key + \"</span>\") ;\n                            cities.overseas[key].forEach((city) => {\n                                $overseasFrame.append(\"<a data-cityid=\\\"\" + city.cityId + \"\\\" data-pinyin=\\\"\" + city.pinyin + \"\\\" data-cityType=\\\"\" + city.cityType + \"\\\">\" + city.cityName + \"</a>\") ;\n                            }) ;\n                        }\n                    }\n                    $(\".city-selector\").append($overseasFrame) ;\n                    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n                    最后给dom节点绑定事件\n                    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n                    this.citySelectorEventDelegate() ;\n                } \n            }) ; \n        }) ;\n         /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        点击汉堡菜单弹出子菜单\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        $(\".conning-tower .hamburg-menu\").click(() => {\n            $(document.body).css({ \"overflow-y\" : \"hidden\" }) ;  //滚动条隐藏\n            $(\".navigator-mask\").fadeIn(100) ;\n            $(\".navigator-pop\").animate( {\n                right : 0\n            } , 100 ) ;\n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        点击子菜单遮罩关闭子菜单\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        $(\".navigator-mask\").click(() => {\n            $(document.body).css({ \"overflow-y\" : \"auto\" }) ;  //如果有滚动条就显示  \n            $(\".navigator-mask\").fadeOut(100) ;\n            $(\".navigator-pop\").animate( {\n                right : \"-200px\"\n            } , 100 ) ;              \n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        点击返回按钮回到假的搜索场景\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        $(\".conning-tower .back\").click(() => {\n            history.back() ;\n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        点击假的搜索区域出现真的搜索\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        $(\".conning-tower dl dd\").click(() => {\n            $(\".substitute-mask\").show(50) ;\n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        真搜索区域返回按钮事件监听\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        $(\".substitute-mask .search-substitute .back\").click(() => {\n            $(\".substitute-mask\").hide(50) ;\n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        真搜索区域清除输入图标事件监听\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        $(\".substitute-mask .search-substitute .input-section .icon-close\").click(() => {\n            $(\".substitute-mask .search-substitute .input-section input\").val(\"\") ;\n            $(\".substitute-mask .list\").empty() ;\n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        pop菜单中的下载APP菜单事件监听\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        $(\".navigator-pop .app-download\").click(() => {\n            nativeSchema.loadSchema({               \n                schema : \"external_call\"  ,  // 通过NN打开某个链接\n                protocal : \"wkzf\" , //schema头协议，实际情况填写\n                loadWaiting : \"1500\" , //发起唤醒请求后，会等待loadWaiting时间，超时则跳转到failUrl，默认3000ms                \n                failUrl : \"https://m.wkzf.com/download/transit?from=esfList\" ,  //唤起失败时的跳转链接，默认跳转到下载页\n                // apk信息,请根据实际情况填写\n                apkInfo : {\n                    PKG : \"com.wukong.ua\" ,\n                    CATEGORY : \"android.intent.category.DEFAULT\" ,\n                    ACTION : \"android.intent.action.VIEW\"\n                }\n            }) ;\n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        真搜索区域输入监听\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        let $input = $(\".substitute-mask .search-substitute .input-section input\") ;\n        $input.keyup(() => {\n            this.request({ \n                apiUrl : this.searchApiUrl , \n                requestData : { \"keyword\" : $.trim($input.val()) } , \n                success : () => {\n                    //对获取到的搜索结果列表进行绘制\n                } \n            }) ;            \n        }) ;\n        \n     }\n     /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    本组件ajax请求封装\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    request({ apiUrl , requestData , success = $.noop }) {\n        try {\n            $.ajax({\n                url : apiUrl ,                    \n                data : requestData ,\n                dataType : \"json\" ,                            \n                error : function(e) {\n                    $.tips( \"调用数据接口：\" + apiUrl + \" 失败！请测试您的数据接口！\" , 3 ) ;                                   \n                } ,\n                success : function(data) {                \n                    if (data.status.toString() === \"1\")  {\n                        //获取到接口数据，进行处理\n                        success(data) ;\n                    }\n                    else $.tips( data.message , 3 ) ;\n                }\n            }) ;\n        }\n        catch(e) {\n            $.tips( \"错误名称：\" + e.name + \"\\n错误描述：\" + e.message , 3 ) ;\n        }\n    }\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    等渲染好城市选择器后进行的事件委托\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n     citySelectorEventDelegate() {\n         let self = this ;\n         /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------         \n        根据tabs-handle的显示状态决定tabs-frame的margin-top值\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        let frameMarginTop = $(\".city-selector .caption .tabs-handle\").is(\":visible\") ? \"72px\" : \"28px\" ;\n        $(\".city-selector .tabs-frame\").css({ \"margin-top\" : frameMarginTop }) ;\n         /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------         \n        城市选择器中根据tabs-handle里面哪个句柄被选中来确定哪个tabs-frame显示\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/        \n        $(\".city-selector .tabs-frame.\" + $(\".city-selector .caption .tabs-handle li.on\").eq(0).data(\"sign\")).show() ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        城市选择器中tabs-handle的点击\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/ \n        let $tabsHandles = $(\".city-selector .caption .tabs-handle li\") ;\n        $tabsHandles.click(function(){\n            $tabsHandles.removeClass(\"on\") ;\n            $(this).addClass(\"on\") ;\n            $(\".city-selector .tabs-frame\").hide() ;\n            $(\".city-selector .tabs-frame.\" + $(this).data(\"sign\")).show() ;\n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        城市选择器中每个城市被点击后干什么\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        $(\".city-selector .tabs-frame a\").click(function() {\n            $(\".conning-tower dl dt span\").text($(this).text()) ;\n            $(\".city-selector\").slideUp(200) ;\n            self.cityClick() ;\n        }) ;\n     }\n     /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    对接口拿到的业务开通城市进行处理\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    filterBusinessCity(data) {\n        let typeMapper = { \"esf\" : 1 , \"rent\" : 2 , \"xf\" : 3 } ;\n        let typeValue = typeMapper[this.moduleType] ;\n        let result = { \"domestic\" : {} , \"overseas\" : {} } ;\n        data && data.domesticCityList && data.domesticCityList.forEach((city) => {\n            let has = false ;\n            city.businessList && city.businessList.forEach((business) => {\n                if(business.businessId === typeValue) has = true ;\n            }) ;\n            if(has) {\n                let shoupin = city.pinyin.charAt(0).toUpperCase() ;\n                if( ! result.domestic.hasOwnProperty(shoupin)) result.domestic[shoupin] = [] ;\n                result.domestic[shoupin].push({ \"cityId\" : city.cityId , \"cityName\" : city.cityName , \"pinyin\" : city.pinyin , \"cityType\" : city.cityType }) ;\n            }\n        }) ;\n        data && data.overseaCityList && data.overseaCityList.forEach((city) => {\n            let has = false ;\n            city.businessList && city.businessList.forEach((business) => {\n                if(business.businessId === typeValue) has = true ;\n            }) ;\n            if(has) {\n                let shoupin = city.pinyin.charAt(0).toUpperCase() ;\n                result.overseas[shoupin].push({ \"cityId\" : city.cityId , \"cityName\" : city.cityName , \"pinyin\" : city.pinyin , \"cityType\" : city.cityType }) ;\n            } \n        }) ;\n        return result ;\n    }\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    发起定位\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    location() {\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        检查浏览器是否支持地理定位\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        if( ! navigator.geolocation ) {\n            $.tips( \"您的浏览器不支持定位地理位置\" , 3 ) ;            \n            return ;\n        }\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        定义定位选项\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        let geoOpts = {\n            enableHighAccuracy : false ,   //表示是否高精度可用，为Boolean类型，默认为false，如果开启，响应时间会变慢，同时，在手机设备上会用掉更多的流量，也就是money了。\n            maximumAge : 0 , //表示应用程序的缓存时间。单位毫秒，默认是0，意味着每次请求都是立即去获取一个全新的对象内容。\n            timeout : 10 * 1000  //表示等待响应的最大时间，默认是0毫秒，表示无穷时间。\n        } ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        开始发起定位\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        navigator.geolocation.getCurrentPosition( (position) => {\n            let latitude = position.coords.latitude ;\n            let longitude = position.coords.longitude ;            \n            /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n            往cookie里面写经纬度\n            -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n            $.cookie(\"locationLatitude\" , latitude , { path : \"/\" } ) ;\n            $.cookie(\"locationLongitude\" , longitude , { path : \"/\" } ) ;              \n            /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n            根据经纬度反查城市信息\n            -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n            this.request({ \n                apiUrl : this.getCityLolaApiUrl , \n                requestData : { \"latitude\" : latitude , \"longitude\" : longitude } , \n                success : () => {\n                    \n                } \n            }) ;                       \n        } , ( error ) => {\n            switch(error.code) {\n                case error.PERMISSION_DENIED :  // 用户阻止了授权\n                this.locationFail() ;\n                break ;\n\n                case error.POSITION_UNAVAILABLE :  //定位信息无效\n                this.locationTimeout() ;\n                break ;\n\n                case error.TIMEOUT :  //定位超时\n                this.locationTimeout() ;\n                break ;\n\n                case error.UNKNOWN_ERROR :  //其他不可预知的错误\n                this.locationTimeout() ;\n                break ;\n            }\n        } , geoOpts ) ;\n\n    }\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    为了保证cookie的统一写入口，页面同步渲染的时候将城市信息放到页面隐藏域中，然后由FE来写到 cookie中\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    setCityCache() {\n        $.cookie(\"selectedCityId\" , $(\"#selectedCityId\").val() , { \"path\" : \"/\" } ) ;\n        $.cookie(\"selectedCityName\" , $(\"#selectedCityName\").val() , { \"path\" : \"/\" } ) ;\n        $.cookie(\"selectedCityPinyin\" , $(\"#selectedCityPinyin\").val() , { \"path\" : \"/\" } ) ;\n    }\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    整个组件定义结束\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n }\n"]}
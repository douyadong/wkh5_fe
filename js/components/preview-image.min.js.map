{"version":3,"sources":["components/preview-image.min.js"],"names":["define","Swiper","addListener","$","on","e","window","preventDefault","stopPropagation","removeListener","off","container","swiper","data","$imgs","find","id","Date","getTime","str","each","index","img","attr","length","click","this","$preview","append","initialSlide","hide","removeClass","slideTo","addClass","show"],"mappings":"AAAA,YAYCA,SAAQ,yCAAyC,SAASC,GAEvD,QAASC,KACLC,EAAE,QAAQC,GAAG,YAAY,SAASC,GAC9BA,EAAIA,GAAKC,OAAOD,EAChBA,EAAEE,iBACFF,EAAEG,oBAIV,QAASC,KACLN,EAAE,QAAQO,IAAI,aAGlB,MAAO,UAASC,GACZ,GAAIC,GAAST,EAAEQ,GAAWE,KAAK,iBAC/B,KAAID,EAAO,CACP,GAAIE,GAAQX,EAAEQ,GAAWI,KAAK,uBAC1BC,GAAM,GAAIC,OAAMC,UAEhBC,EAAM,mDAAmDH,EAAG,gCAEhEF,GAAMM,KAAK,SAASC,EAAMC,GACtBH,GAAO,iEAEsBhB,EAAEmB,GAAKC,KAAK,OAAO,6BAE/BF,EAAQ,GAAK,IAAOP,EAAMU,OAC3B,qBAGhBrB,EAAEmB,GAAKT,KAAK,QAAQQ,KAGxBF,GAAO,eAEPL,EAAMW,MAAM,WACR,GAAIJ,GAAQlB,EAAEuB,MAAMb,KAAK,SACrBc,EAAWxB,EAAE,IAAIa,EACC,IAAnBW,EAASH,SACRrB,EAAE,QAAQyB,OAAOT,GACjBP,EAASX,EAAO,IAAMe,GAClBa,aAAcR,IAElBlB,EAAEQ,GAAWE,KAAK,iBAAiBD,GAGnCT,EAAE,IAAMa,GAAIZ,GAAG,QAAQ,WACnBD,EAAEuB,MAAMI,OACR3B,EAAE,QAAQ4B,YAAY,sBACtB5B,EAAE,QAAQ4B,YAAY,sBACtBtB,OAIRG,EAAOoB,QAAQX,GACflB,EAAE,QAAQ8B,SAAS,sBACnB9B,EAAE,QAAQ8B,SAAS,sBACnB/B,IACAyB,EAASO","file":"preview-image.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n 1. 项目名称：悟空找房h5\r\n 2. 页面名称：components -> preview-image(图片预览)\r\n 3. 作者：tangxuyang@lifang.com\r\n 4. 依赖：swiper\r\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n/**\r\n * 用法：\r\n * PreviewImage(container)\r\n * container: 是包含有图片的容器，其中图片要有preview-image-item类\r\n */\r\n\r\n define(['../components/swiper-3.4.2.jquery.min'],function(Swiper){\r\n\r\n    function addListener(){\r\n        $('body').on('touchmove',function(e){\r\n            e = e || window.e;\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        })\r\n    }\r\n\r\n    function removeListener(){\r\n        $('body').off('touchmove');\r\n    }\r\n\r\n    return function(container){\r\n        let swiper = $(container).data('preview-swiper');            \r\n        if(!swiper){\r\n            let $imgs = $(container).find('.preview-image-item');//获取所有要预览的图片\r\n            let id = (new Date).getTime();\r\n\r\n            let str = '<div class=\"swiper-container preview-image\" id=\"'+id+'\">' + \r\n                        '<div class=\"swiper-wrapper\">';\r\n            $imgs.each(function(index,img){\r\n                str += '<div class=\"swiper-slide\">' + \r\n                            '<div class=\"preview-item\">' +\r\n                                '<img src=\"'+$(img).attr('src')+'\">' + \r\n                                '<div class=\"indicator\">' + \r\n                                (index + 1) + '/' + ($imgs.length) + \r\n                                '</div>' + \r\n                            '</div>' +\r\n                        '</div>'; \r\n                $(img).data('index',index);           \r\n            });\r\n            \r\n            str += \"</div></div>\";         \r\n                \r\n            $imgs.click(function(){\r\n                let index = $(this).data('index');\r\n                let $preview = $('#'+id);\r\n                if($preview.length == 0){\r\n                    $('body').append(str);\r\n                    swiper = Swiper('#' + id, {\r\n                        initialSlide: index\r\n                    });\r\n                    $(container).data('preview-swiper',swiper);\r\n\r\n                    //退出预览模式\r\n                    $('#' + id).on('click',function(){                                     \r\n                        $(this).hide();\r\n                        $('body').removeClass('preview-image-open');//\r\n                        $('html').removeClass('preview-image-open');\r\n                        removeListener();\r\n                    });\r\n                }\r\n\r\n                swiper.slideTo(index);\r\n                $('body').addClass('preview-image-open');//去掉垂直滚动条\r\n                $('html').addClass('preview-image-open');\r\n                addListener();\r\n                $preview.show();                \r\n            });            \r\n        } else {\r\n            \r\n        }\r\n\r\n        \r\n    };\r\n\r\n    /*\r\n        <div class=\"swiper-container\">\r\n            <div class=\"swiper-wrapper\">\r\n                <%\r\n                    if(imgList && imgList.length> 0){\r\n                        for(let i = 0; i < imgList.length; i++){\r\n                            if(!imgList[i].isVideo){\r\n                %>\r\n                    <div class=\"swiper-slide\">\r\n                        <div class=\"preview-item\">\r\n                            <img src=\"\">\r\n                            <div class=\"indicator\">\r\n                                <%= i+1 - startIndex%>/<%= imgList.length - startIndex%>\r\n                            </div>             \r\n                        </div>\r\n                    </div>\r\n                <%\r\n                            }\r\n                        }\r\n                    }\r\n                %>\r\n                \r\n            </div>\r\n        </div>\r\n    */\r\n\r\n\r\n\r\n });"]}
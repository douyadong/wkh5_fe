{"version":3,"sources":["xf/list.min.js"],"names":["ListController","self","paramGenerator","ParamGenerator","setTimeout","$","slideDown","slideUp","lazyload","staticDomain","require","Filter","BigData","XfAds","xfAds","on","close","open","init","ConningTower","data","param","di","to","li","st","id","sdi","sto","sli","sst","sid","lat","lon","m","mapping","key","type","value","goto","visitedCityId","val","highPriceCityIds","prices","filter","cityId","length","LOWPRICES","extend","XFDEFAULT","el","near","controller","filterChanged","result","generateParamObj","DistrictAndMetroUnlimited","forEach","item","bigData","pageUrl","location","origin","pathname","replace","tmpArr","split","obj","queryString2Object","window","bindEvent","pullload","insertTrendAndOldHouse","cityPinyin","url","object2QueryString","href","search","click","str","channel","encryptSubEstateId","encodeURIComponent","subEstateId","imageUrl","hasVideo","activitys","title","estateName","districtName","townName","startSpace","endSpace","hasActivity","isSubwayEstate","isOnSale","isSoonOpen","avgPriceWou","count","hideNoData","hide","createHouseItems","html","text","showNoData","append","show","cityName","$list","oldBusiness","JSON","stringify","eventName","eventParam","city_id","insertAfter","addClass","apiUrl","xf","list","itemClass","queryStringObject","pa","requestType","threshold","pageSize","pageIndexKey","pageSizeKey","callback","newHouseDataListModelList","appendHouseList","Controller","document","ready"],"mappings":"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","file":"list.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n 1. 项目名称：悟空找房h5\r\n 2. 页面名称：xf/list(新房-列表)\r\n 3. 作者：tangxuyang@lifang.com\r\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n class ListController extends Controller {\r\n    constructor() {\r\n        super();\r\n        var self = this;        \r\n        this.paramGenerator = new ParamGenerator();\r\n        setTimeout(function(){\r\n            $('.total').slideDown(function(){\r\n                setTimeout(function(){\r\n                    $('.total').slideUp();\r\n                },2000);\r\n            });// 隐藏查询总条数   \r\n        },100) ;       \r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        图片懒加载实例化\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/        \r\n        $(\".lazy\").lazyload({ \r\n            \"placeholder\" : this.staticDomain + \"/wkh5_fe/images/common/loading.jpg\"\r\n        }) ;\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        加载组件\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/ \r\n        require(['../components/filter.min', '../components/bigdata.min' , \"./ads.min\", \"../components/conning-tower.min\"], function(Filter, BigData , XfAds) {\r\n            /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n            实例化广告组件，点击筛选区域的时候需要隐藏广告\r\n            -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/  \r\n            let xfAds = new  XfAds ;\r\n            $('.filter').on('show.filter',function(){\r\n         xfAds.close() ;\r\n       }).on('hide.filter',function(){\r\n         xfAds.open() ;\r\n       }) ;\r\n            /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n            大数据埋点工具初始化\r\n            -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/  \r\n            BigData.init(self) ;      \r\n            new ConningTower({                \r\n                \"bigDataUtil\" : BigData ,               \r\n                \"moduleType\" : \"xf\" ,\r\n                \"cityClick\" : (data) => {\r\n                } ,\r\n                \"searchResultItemClick\" : (data) => {                    \r\n                    // 与filter中的区域地铁互斥\r\n                    delete self.param.di;// 区域id\r\n                    delete self.param.to;// 板块id\r\n                    delete self.param.li;// 地铁线id\r\n                    delete self.param.st;// 地铁站id\r\n                    delete self.param.id;// 小区id\r\n                    delete self.param.sdi;// 区域id\r\n                    delete self.param.sto;// 板块id\r\n                    delete self.param.sli;// 地铁线id\r\n                    delete self.param.sst;// 地铁站id\r\n                    delete self.param.sid;// 小区id\r\n                    delete self.param.lat;\r\n                    delete self.param.lon;\r\n                    delete self.param.m;\r\n                    var mapping = [\"\",\"sdi\",\"sto\",\"sli\",\"sst\",\"sid\"];\r\n                    var key = mapping[data.type];\r\n                    if(key){\r\n                        self.param[key] = data.value;\r\n                        self.goto();\r\n                    }                    \r\n                },\r\n            }) ;\r\n\r\n            // 城市不同总价选项不同，XFDEFAULT中prices是北京、上海、广州、深圳、杭州、苏州、廊坊、南京的价格选项，比较高，\r\n            // 因此需要区分\r\n            /*\r\n            *   北京\t3\r\n                上海\t43\r\n                广州\t1873\r\n                深圳\t1950\r\n                杭州\t873\r\n                苏州\t771\r\n                廊坊\t221\r\n                南京\t741\r\n            */\r\n\r\n            var visitedCityId = $('#visitedCityId').val();\r\n            var highPriceCityIds = [3,43,1873,1950,873,771,221,741];\r\n            var prices = highPriceCityIds.filter(function(cityId){return cityId == visitedCityId }).length == 0 ? Filter.LOWPRICES : null;\r\n\r\n            self.filter = new Filter($.extend({},Filter.XFDEFAULT,{\r\n                el: \".filter\",                \r\n                cityId: visitedCityId,\r\n                near: false,               \r\n                controller: self,\r\n                BigData: BigData,\r\n                filterChanged: function(result){   \r\n                    var param = self.paramGenerator.generateParamObj(result);\r\n                    if(param.di || param.to || param.li || param.st || param.lat || param.lon || result.DistrictAndMetroUnlimited){\r\n                        \r\n                    }else{// 判断是否有sid,sli,sst,sdi,sto\r\n                        var mapping = [\"sdi\",\"sto\",\"sli\",\"sst\",\"sid\"];\r\n                        mapping.forEach(function(item){\r\n                            if(self.param[item]){\r\n                                param[item] = self.param[item];\r\n                            }\r\n                        });                        \r\n                    }\r\n\r\n                    self.param = param;\r\n                    // 跳转\r\n                    self.goto();\r\n                }                \r\n            }, prices));   \r\n            \r\n            self.BigData = BigData;\r\n            BigData.bigData({\r\n                \"pageName\": \"1050\",                       \r\n                \"type\": 1\r\n            });\r\n        });\r\n\r\n        // 从url中解析参数\r\n        //var pageUrl = location.href;\r\n        var pageUrl = location.origin + location.pathname;\r\n        pageUrl = pageUrl.replace('//','');\r\n        var tmpArr = pageUrl.split('/');\r\n        self.param = {};\r\n        if(tmpArr[3]){// 有查询条件\r\n            var obj = ParamGenerator.queryString2Object(tmpArr[3]);\r\n            if(obj){\r\n                self.param = obj;\r\n            }\r\n        }\r\n                    \r\n        window.filter = self.filter;\r\n\r\n        this.bindEvent();\r\n        this.pullload();\r\n        this.insertTrendAndOldHouse();\r\n    }\r\n\r\n    // 根据查询条件进行相应的跳转\r\n    goto(){    \r\n        var cityPinyin = $('#visitedCityPinyin').val();\r\n        var url = location.origin + \"/\" + cityPinyin + \"/xflist/\" +ParamGenerator.object2QueryString(this.param);\r\n        location.href = url + location.search;\r\n    }\r\n\r\n    bindEvent(){\r\n        var self = this;\r\n        // 清空查询条件\r\n        $('.no-data button').click(function(){\r\n            // 跳转            \r\n            location.href = \"./\";\r\n        });\r\n    }    \r\n\r\n    createHouseItems(data){\r\n        var str = \"\";\r\n        var cityPinyin = $('#visitedCityPinyin').val();\r\n        var channel = $('#channel').val();\r\n        data.forEach(function(item){\r\n            str += '<a class=\"xf-item\" href=\"/'+cityPinyin+'/xf/'+item.encryptSubEstateId+'.html' +(channel? '?channel='+channel : \"\")+'\" data-bigdata=\"'+encodeURIComponent('{\"eventName\": \"1050025\", \"eventParam\": {\"new_house_id\":\"'+item.subEstateId+'\"}}')+'\">\\\r\n                <div class=\"img\">\\\r\n                    <img src=\"'+item.imageUrl+'\">'\r\n                    + (item.hasVideo == '1' && '<span class=\"play\"><i></i></span>' || '') +'\\\r\n                    <div class=\"yh\">'+(item.activitys && item.activitys[0] && item.activitys[0].title || '')+'</div>\\\r\n                </div>\\\r\n                <div class=\"info\">\\\r\n                    <h3>'+item.estateName+'</h3>\\\r\n                    <p class=\"district-town-area\">\\\r\n                        <span>'+item.districtName+' '+item.townName+'</span><span>'+item.startSpace+'m²-'+item.endSpace+'m²</span>\\\r\n                    </p>\\\r\n                    <ul class=\"tags\">'\r\n                + (item.hasActivity =='1' && '<li class=\"yh\">有优惠</li>' || \"\") + (item.isSubwayEstate == '1'&&'<li class=\"dt\">近地铁</li>'||'') + ( (item.isOnSale == '1' || item.isSoonOpen == '2') &&'<li>在售楼盘</li>'||'<li>即将开盘</li>') + (item.hasVideo == '1' &&'<li>有视频</li>'||'') +\r\n                    '</ul>\\\r\n                    <p class=\"unit-price\"><span'+(item.avgPriceWou==\"0\"&&\" class='normal'\"||'' )+'>'+(item.avgPriceWou!='0'?item.avgPriceWou:'价格待定')+'</span> '+ (item.avgPriceWou!='0' && '<span>元/m²</span>' || '') +'</p>\\\r\n                </div>\\\r\n            </a>';\r\n        });\r\n\r\n        return str;\r\n    }    \r\n\r\n    createHouseList(data,count){// 生成房源列表\r\n        this.hideNoData();\r\n        if(data && data.length){\r\n            $('.no-data').hide();\r\n            var str = this.createHouseItems(data);\r\n\r\n            $('#list').html(str);\r\n            $('.total .count').text(count);\r\n            $('.total').slideDown();\r\n            setTimeout(function(){\r\n                $('.total').slideUp();\r\n            }, 1500);\r\n\r\n            this.insertTrendAndOldHouse();\r\n        }else{// 没数据\r\n            this.showNoData();\r\n        }\r\n    }\r\n\r\n    appendHouseList(data){// 上拉滚动时加载数据\r\n        if(data&&data.length){\r\n            var str = this.createHouseItems(data);\r\n            $('#list').append(str);\r\n            this.insertTrendAndOldHouse();\r\n        }else{// 没有更多数据了\r\n            //this.showNoMore();\r\n        }\r\n    }\r\n\r\n    showNoData(){// 显示没有数据，并显示新房楼盘推荐\r\n        $('.no-data').show();\r\n        $('.total + div').html('');        \r\n    }\r\n\r\n    hideNoData(){\r\n        $('.no-data').hide();\r\n    }\r\n\r\n    hideNoMore(){\r\n        $('.reach-bottom').hide();\r\n    }\r\n\r\n    insertTrendAndOldHouse(){// 场景连篇        \r\n        var cityName = $('#visitedCityName').val();\r\n        var cityPinyin = $('#visitedCityPinyin').val();\r\n        var cityId = $('#visitedCityId').val();\r\n        var channel = $('#channel').val();\r\n        var $list = $('#list .xf-item');\r\n        var oldBusiness = $('#oldBusiness').val();\r\n        if($('#list .scene.house-price').length == 0 && $list.length>9){\r\n            $('<a data-bigdata=\"'+encodeURIComponent(JSON.stringify({eventName:\"1050056\", eventParam:{city_id: cityId}}))+'\" href=\"/'+cityPinyin+'/trend/new'+(channel? \"?channel=\" + channel:\"\")+'\" class=\"scene house-price\">\\\r\n                <div class=\"img\"></div>\\\r\n                <div class=\"info\">\\\r\n                    <h3>'+cityName+'房价涨了还是跌了？</h3>\\\r\n                    <span class=\"detail\">去看看</span>\\\r\n                </div>\\\r\n            </a>').insertAfter($($list[9]).addClass('remove-baseline'));\r\n        }\r\n        if(oldBusiness && $('#list .scene.house').length == 0 && $list.length>19){\r\n            $('<a data-bigdata=\"'+encodeURIComponent(JSON.stringify({eventName: \"1050057\", eventParam: {city_id: cityId}}))+'\" href=\"/'+cityPinyin+'/esf/'+(channel? \"?channel=\" + channel:\"\")+'\" class=\"scene house\">\\\r\n                <div class=\"img\"></div>\\\r\n                <div class=\"info\">\\\r\n                    <h3>火爆高性价比二手房</h3>\\\r\n                    <span class=\"detail\">去看看</span>\\\r\n                </div>\\\r\n            </a>').insertAfter($($list[19]).addClass('remove-baseline'));\r\n        }\r\n    }\r\n\r\n    showError(){// 接口报错，分为两种，1. 筛选条件变更刷新 2. 上拉加载\r\n\r\n    }\r\n\r\n    // 上拉加载\r\n    pullload(){\r\n        let self = this ;\r\n\r\n        //二手房\r\n        $(\"#list\").pullload({\r\n            apiUrl : self.apiUrl.xf.list ,\r\n            itemClass: \".xf-item\",\r\n            queryStringObject : function(){\r\n                self.param && delete self.param.pa;\r\n                if(!self.param){\r\n                    self.param = {};\r\n                }\r\n                return $.extend({},self.param,{cityId: $('#visitedCityId').val()});\r\n            },   \r\n            requestType: \"POST\",\r\n            threshold : 50 ,\r\n            pageSize: 10,   \r\n            pageIndexKey: \"of\",\r\n            pageSizeKey: \"ps\",    \r\n            callback : function(data) {\r\n                \r\n                if( !data.data || !data.data.newHouseDataListModelList || !data.data.newHouseDataListModelList.length){\r\n                    data.count = 1;\r\n                    return;    \r\n                } \r\n\r\n                self.appendHouseList(data.data.newHouseDataListModelList);                \r\n            }\r\n        }) ;\r\n    }\r\n}\r\n\r\n\r\n\r\n/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n类的初始化\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n$(document).ready(function() {\r\n    new ListController;\r\n});"]}
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),DetailController=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));$(".lazy").lazyload({placeholder:e.staticDomain+"/wkh5_fe/images/common/loading.jpg"}),e.addListenerToDownloadApp(),$(".download-app .download").click(function(){nativeSchema.loadSchema({schema:"external_call/parameter?t=0&bt=1&houseId="+$("#houseId").val()+"&systemHouseType=1",protocal:"wkzf",loadWaiting:"1500",failUrl:"https://m.wkzf.com/download/transit?from=esfDetail",apkInfo:{PKG:"com.wukong.ua",CATEGORY:"android.intent.category.DEFAULT",ACTION:"android.intent.action.VIEW"}})}),e.addListenerToAssistant(),e.fiveLine();var a=$("#estateName").attr("data-encryptsubestateid"),o=e;e.request(e.apiUrl.community.chart,{subEstateId:a},{successCallback:function(e){if(1==e.status){var t=e,a=o.recombineM(t.data);o.echartFun(a)}}});var n=e;return require(["../components/album.min","../components/bigdata.min"],function(e,t){t.init(o),t.bigData({pageName:"1067",pageParam:{house_id:$("#estateName").attr("data-houseid"),boutique:$("#estateName").attr("data-boutique")},channel:n.GetRequest().channel||"",type:1})}),e}return _inherits(t,e),_createClass(t,[{key:"fiveLine",value:function(){$(".more").hide();var e=Math.round($(".base-info").height()/parseFloat($(".base-info").css("line-height")));e>5?($(".base-info").addClass("word-line"),$(".more").show()):($(".base-info").removeClass("word-line"),$(".more").hide()),$(".more").click(function(){$(".base-info").removeClass("word-line"),$(".more").hide()})}},{key:"echartFun",value:function(e){var t=[],a=0,o=!0;if(e.seriesData.forEach(function(e,n){0==e?(t.push(null),a+=1,11==a&&10==n&&(o=!1)):t.push(parseFloat(e))}),!o)return void $("#estateNameEcharts").hide();var n=e.seriesData.sort(function(e,t){return parseFloat(e)-parseFloat(t)}),i=1e3*Math.ceil(n[n.length-1]/1e3),r=[];n.forEach(function(e,t){0!=e&&r.push(e)});var s=1e3*Math.ceil(r[0]/1e3-1),l=1e3;n[n.length-1]==r[0]?(s-=2e3,l=1e3):l=(i-s)/4<1e3?1e3:1e3*Math.ceil((i-s)/4e3),s=s<0?0:s;var c=s-l>0?"#979797":"#fff",u=echarts.init(document.getElementById("main"),{width:"88%"}),f=this,h=$("#estateName").attr("data-houseid"),d=$("#estateName").attr("data-subestateid"),p={eventName:"1067014",eventParam:{house_id:h,estate_id:d},type:2},m={tooltip:{trigger:"item",triggerOn:"click",position:"top",backgroundColor:"#4081D6",padding:4,textStyle:{color:"#fff",fontSize:"12"},formatter:function(e,t,a){var o=e.value+"元";return f.request(f.apiUrl.common.bigData,p,function(){}),o}},grid:{bottom:20,left:"3%",right:"10%",containLabel:!0},xAxis:{show:!0,data:e.monthList,splitLine:{show:!1},axisTick:{show:!1},position:"bottom",type:"category",boundaryGap:!1,axisLine:{lineStyle:{color:c}},axisLabel:{interval:0,rotate:0,textStyle:{color:"#999",fontSize:12,fontFamily:"微软雅黑"}}},yAxis:{axisLine:{show:!1},splitLine:{show:!0,interval:function(e,t){},lineStyle:{color:["#979797"]}},axisTick:{show:!1},axisLabel:{inside:!1,textStyle:{color:"#999"},formatter:function(e,t){return 0==t?"":(e/1e4).toFixed(1)+" 万"}},min:s-l,max:s+4*l,interval:l},series:[{name:"销量",type:"line",lineStyle:{normal:{color:"#4081D6"}},itemStyle:{normal:{color:"#4081D6"},emphasis:{borderColor:"#4081D6",borderWidth:2,color:"#4081D6"}},symbolSize:5,connectNulls:!0,data:t}]};u.setOption(m)}},{key:"recombineM",value:function(e){var t={monthList:[],seriesData:[]};return e&&e.forEach(function(e){var a=e.date.split("-")[1];0==a.indexOf("0")?t.monthList.push(a.charAt(1)+"月"):t.monthList.push(a+"月"),t.seriesData.push(e.unitPrice)}),console.log(t),t}},{key:"GetRequest",value:function(){var e=location.search,t={};if(e.indexOf("?")!==-1)for(var a=e.substr(1),o=a.split("&"),n=0;n<o.length;n++)t[o[n].split("=")[0]]=o[n].split("=")[1];return t}}]),t}(Controller);$(document).ready(function(){new DetailController});
//# sourceMappingURL=detail.min.js.map

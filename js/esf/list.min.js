"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),ListController=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),a=e;e.paramGenerator=new ParamGenerator,setTimeout(function(){$(".total").slideDown(function(){setTimeout(function(){$(".total").slideUp()},2e3)})},100),$(".lazy").lazyload({placeholder:e.staticDomain+"/wkh5_fe/images/common/loading.jpg"}),require(["../components/bigdata.min","../components/filter.min","../components/conning-tower.min"],function(t,n){t.init(e);var i=$("#visitedCityId").val(),s=[3,43,1873,1950,873,771,221,741],o=0==s.filter(function(e){return e==i}).length?n.LOWPRICES:null;a.filter=new n($.extend({},n.ESFDEFAULT,{el:".filter",cityId:$("#visitedCityId").val(),BigData:t,controller:a,near:!0,filterChanged:function(e){var t=a.paramGenerator.generateParamObj(e);if(t.di||t.to||t.li||t.st);else{var n=["sdi","sto","sli","sst","sid"];n.forEach(function(e){a.param[e]&&(t[e]=a.param[e])})}a.param=t,a["goto"]()}},o)),new ConningTower({bigDataUtil:t,moduleType:"esf",cityClick:function(){},searchResultItemClick:function(e){delete a.param.di,delete a.param.to,delete a.param.li,delete a.param.st,delete a.param.id,delete a.param.sdi,delete a.param.sto,delete a.param.sli,delete a.param.sst,delete a.param.sid,delete a.param.lat,delete a.param.lon,delete a.param.m;var t=["","sdi","sto","sli","sst","sid"],n=t[e.type];n&&(a.param[n]=e.value,a["goto"]())},locationCallback:function(e){a.filter.setLocationInfo(e)}}),window.filter=a.filter,a.BigData=t,t.bigData({pageName:"1068",type:1})});var n=location.origin+location.pathname;n=n.replace("//","");var i=n.split("/");if(a.param={},i[3]){var s=ParamGenerator.queryString2Object(i[3]);s&&(a.param=s)}return e.bindEvent(),e.pullload(),e.insertTrendAndOldHouse(),e}return _inherits(t,e),_createClass(t,[{key:"goto",value:function(){var e=$("#visitedCityPinyin").val(),t=location.origin+"/"+e+"/esf/"+ParamGenerator.object2QueryString(this.param);location.href=t+location.search}},{key:"bindEvent",value:function(){$(".no-data button").click(function(){location.href="./"})}},{key:"createHouseItems",value:function(e){var t="",a=$("#visitedCityPinyin").val(),n=$("#channel").val();return e.forEach(function(e){t+='<a href="/'+a+"/esf/"+e.encryptHouseId+".html"+(n?"?channel="+n:"")+'" class="esf-item" data-bigdata="'+encodeURIComponent('{"eventName": "1068028", "eventParam": { "house_id": "'+e.houseId+'" }}')+'">            <dl>                <dt><img src="'+e.houseImgUrl+'?x-oss-process=image/resize,w_150" alt="'+e.estateName+'" class="lazy">'+("1"==e.hasVideo&&'<span class="play"><i></i></span>'||"")+'</dt>                <dd class="title">'+e.houseTitle+"</dd>                <dd>"+e.houseChild+" "+e.areaStr+" | "+e.district+" "+e.town+' </dd>                <dd class="tags">'+(e.tagList?e.tagList.map(function(e){switch(e){case"降价":return'<div class="promotion"><span>降价</span></div>';case"新上":return'<div class="new"><span>新上</span></div>';case"满二":return'<div class="over"><span>满二</span></div>';case"满五唯一":return'<div class="over"><span>满五唯一</span></div>';default:return"<div><span>"+e+"</span></div>"}}).join(""):"")+'</dd>                <dd>                     <span class="money">'+e.totalPrice+'万</span>                     <span class="price">'+e.unitPrice+" 元/㎡</span>                </dd>            </dl>        </a>"}),t}},{key:"createHouseList",value:function(e,t){if(this.hideNoData(),e&&e.length){$(".no-data").hide();var a=this.createHouseItems(e);$("#list").html(a),$(".total .count").text(t),$(".total").slideDown(),setTimeout(function(){$(".total").slideUp()},1500),this.insertTrendAndOldHouse()}else this.showNoData()}},{key:"appendHouseList",value:function(e){if(e&&e.length){var t=this.createHouseItems(e);$("#list").append(t),this.insertTrendAndOldHouse()}}},{key:"showNoData",value:function(){$(".no-data").show(),$(".total + div").html(""),$(".recommendation").show()}},{key:"hideNoData",value:function(){$(".no-data").hide()}},{key:"hideNoMore",value:function(){$(".reach-bottom").hide()}},{key:"insertTrendAndOldHouse",value:function(){var e=$("#visitedCityName").val(),t=$("#visitedCityPinyin").val(),a=$("#visitedCityId").val(),n=$("#channel").val(),i=$("#list .esf-item"),s=$("#newBusiness").val();0==$("#list .scene.house-price").length&&i.length>9&&$('<a data-bigdata="'+encodeURIComponent(JSON.stringify({eventName:"1068074",eventParam:{city_id:a}}))+'" href="/'+t+"/trend/esf"+(n?"?channel="+n:"")+'" class="scene house-price">                <div class="img"></div>                <div class="info">                    <h3>'+e+'房价涨了还是跌了？</h3>                    <span class="detail">去看看</span>                </div>            </a>').insertAfter($(i[9])),s&&0==$("#list .scene.house").length&&i.length>19&&$('<a data-bigdata="'+encodeURIComponent(JSON.stringify({eventName:"1068075",eventParam:{city_id:a}}))+'" href="/'+t+"/xflist/"+(n?"?channel="+n:"")+'" class="scene house">                <div class="img"></div>                <div class="info">                    <h3>火爆高性价比新房</h3>                    <span class="detail">去看看</span>                </div>            </a>').insertAfter(i[19])}},{key:"showError",value:function(){}},{key:"pullload",value:function(){var e=this;$("#list").pullload({apiUrl:e.apiUrl.esf.list.houselist,itemClass:".esf-item",queryStringObject:function(){return e.param&&delete e.param.pa,e.param||(e.param={}),$.extend({},e.param,{cityId:$("#visitedCityId").val()})},requestType:"POST",threshold:50,pageSize:10,pageIndexKey:"of",pageSizeKey:"ps",callback:function(t){return t.data&&t.data.houseList&&t.data.houseList.length?void e.appendHouseList(t.data.houseList):void(t.count=1)}})}}]),t}(Controller);$(document).ready(function(){new ListController});
//# sourceMappingURL=list.min.js.map

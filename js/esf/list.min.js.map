{"version":3,"sources":["esf/list.min.js"],"names":["ListController","self","paramGenerator","ParamGenerator","setTimeout","$","slideDown","slideUp","lazyload","staticDomain","require","BigData","Filter","AsyncItem","init","visitedCityId","val","highPriceCityIds","prices","filter","cityId","length","LOWPRICES","extend","ESFDEFAULT","el","controller","near","filterChanged","result","param","generateParamObj","di","to","li","st","DistrictAndMetroUnlimited","mapping","forEach","item","goto","ConningTower","data","id","sdi","sto","sli","sst","sid","lat","lon","m","key","type","value","setLocationInfo","bigData","pageUrl","location","origin","pathname","replace","tmpArr","split","obj","queryString2Object","bindEvent","pullload","insertTrendAndOldHouse","on","console","log","cityPinyin","url","object2QueryString","href","search","click","str","channel","encryptHouseId","encodeURIComponent","houseId","houseImgUrl","estateName","hasVideo","houseTitle","houseChild","areaStr","district","town","tagList","map","tag","join","totalPrice","unitPrice","bigDataParams","esf","append","show","html","hide","cityName","$list","newBusiness","JSON","stringify","eventName","eventParam","city_id","insertAfter","addClass","apiUrl","list","houselist","itemClass","queryStringObject","pa","requestType","threshold","pageSize","pageIndexKey","pageSizeKey","callback","houseList","count","appendHouseList","Controller","document","ready"],"mappings":";;;;;;;;;;AAAA;;;;;IAKMA,c;;;AACF,8BAAc;AAAA;;AAAA;AACV;;;;;AAIA,YAAIC,YAAJ;AACA,cAAKC,cAAL,GAAsB,IAAIC,cAAJ,EAAtB;AACAC,mBAAW,YAAU;AACjBC,cAAE,QAAF,EAAYC,SAAZ,CAAsB,YAAU;AAC5BF,2BAAW,YAAU;AACjBC,sBAAE,QAAF,EAAYE,OAAZ;AACH,iBAFD,EAEE,IAFF;AAGH,aAJD,EADiB,CAKd;AACN,SAND,EAME,GANF;;AAQA;;;AAGAF,UAAE,OAAF,EAAWG,QAAX,CAAoB;AAChB,2BAAgB,MAAKC,YAAL,GAAoB;AADpB,SAApB;;AAIA;;;AAGAC,gBAAQ,CAAE,2BAAF,EAAgC,0BAAhC,EAA4D,8BAA5D,EAA4F,iCAA5F,CAAR,EAA0I,UAACC,OAAD,EAAUC,MAAV,EAAkBC,SAAlB,EAAgC;AACtKF,oBAAQG,IAAR;;AAEA;AACA;AACA;;;;;;;;;;;AAWA,gBAAIC,gBAAgBV,EAAE,gBAAF,EAAoBW,GAApB,EAApB;AACA,gBAAIC,mBAAmB,CAAC,CAAD,EAAG,EAAH,EAAM,IAAN,EAAW,IAAX,EAAgB,GAAhB,EAAoB,GAApB,EAAwB,GAAxB,EAA4B,GAA5B,CAAvB;AACA,gBAAIC,SAASD,iBAAiBE,MAAjB,CAAwB,UAASC,MAAT,EAAgB;AAAC,uBAAOA,UAAUL,aAAjB;AAAgC,aAAzE,EAA2EM,MAA3E,IAAqF,CAArF,GAAyFT,OAAOU,SAAhG,GAA4G,IAAzH;;AAEArB,iBAAKkB,MAAL,GAAc,IAAIP,MAAJ,CAAWP,EAAEkB,MAAF,CAAS,EAAT,EAAaX,OAAOY,UAApB,EAA+B;AACpDC,oBAAI,SADgD;AAEpDL,wBAAQf,EAAE,gBAAF,EAAoBW,GAApB,EAF4C;AAGpDL,yBAASA,OAH2C;AAIpDe,4BAAYzB,IAJwC;AAKpD0B,sBAAM,IAL8C;AAMpDC,+BAAe,uBAASC,MAAT,EAAgB;AAC3B,wBAAIC,QAAQ7B,KAAKC,cAAL,CAAoB6B,gBAApB,CAAqCF,MAArC,CAAZ;AACA,wBAAGC,MAAME,EAAN,IAAYF,MAAMG,EAAlB,IAAwBH,MAAMI,EAA9B,IAAoCJ,MAAMK,EAA1C,IAAgDN,OAAOO,yBAA1D,EAAoF;AAChF;AACH,qBAFD,MAEK;AAAC;AACF,4BAAIC,UAAU,CAAC,KAAD,EAAO,KAAP,EAAa,KAAb,EAAmB,KAAnB,EAAyB,KAAzB,CAAd;AACAA,gCAAQC,OAAR,CAAgB,UAASC,IAAT,EAAc;AAC1B,gCAAGtC,KAAK6B,KAAL,CAAWS,IAAX,CAAH,EAAoB;AAChBT,sCAAMS,IAAN,IAActC,KAAK6B,KAAL,CAAWS,IAAX,CAAd;AACH;AACJ,yBAJD;AAKH;;AAGDtC,yBAAK6B,KAAL,GAAaA,KAAb;AACA;AACA7B,yBAAKuC,IAAL;AACH;AAvBmD,aAA/B,EAwBvBtB,MAxBuB,CAAX,CAAd;AAyBA,gBAAIuB,YAAJ,CAAiB;AACb,+BAAgB9B,OADH;AAEb,8BAAe,KAFF;AAGb,6BAAc,qBAAM,CAEnB,CALY;AAMb,yCAA0B,+BAAC+B,IAAD,EAAU;AAChC;AACA,2BAAOzC,KAAK6B,KAAL,CAAWE,EAAlB,CAFgC,CAEX;AACrB,2BAAO/B,KAAK6B,KAAL,CAAWG,EAAlB,CAHgC,CAGX;AACrB,2BAAOhC,KAAK6B,KAAL,CAAWI,EAAlB,CAJgC,CAIX;AACrB,2BAAOjC,KAAK6B,KAAL,CAAWK,EAAlB,CALgC,CAKX;AACrB,2BAAOlC,KAAK6B,KAAL,CAAWa,EAAlB,CANgC,CAMX;AACrB,2BAAO1C,KAAK6B,KAAL,CAAWc,GAAlB,CAPgC,CAOV;AACtB,2BAAO3C,KAAK6B,KAAL,CAAWe,GAAlB,CARgC,CAQV;AACtB,2BAAO5C,KAAK6B,KAAL,CAAWgB,GAAlB,CATgC,CASV;AACtB,2BAAO7C,KAAK6B,KAAL,CAAWiB,GAAlB,CAVgC,CAUV;AACtB,2BAAO9C,KAAK6B,KAAL,CAAWkB,GAAlB,CAXgC,CAWV;AACtB,2BAAO/C,KAAK6B,KAAL,CAAWmB,GAAlB;AACA,2BAAOhD,KAAK6B,KAAL,CAAWoB,GAAlB;AACA,2BAAOjD,KAAK6B,KAAL,CAAWqB,CAAlB;AACA,wBAAId,UAAU,CAAC,EAAD,EAAI,KAAJ,EAAU,KAAV,EAAgB,KAAhB,EAAsB,KAAtB,EAA4B,KAA5B,CAAd;AACA,wBAAIe,MAAMf,QAAQK,KAAKW,IAAb,CAAV;AACA,wBAAGD,GAAH,EAAO;AACHnD,6BAAK6B,KAAL,CAAWsB,GAAX,IAAkBV,KAAKY,KAAvB;AACArD,6BAAKuC,IAAL;AACH;AACJ,iBA3BY;AA4Bb,oCAAoB,0BAACE,IAAD,EAAQ;AACxBzC,yBAAKkB,MAAL,CAAYoC,eAAZ,CAA4Bb,IAA5B;AACH;AA9BY,aAAjB;;AAiCAzC,iBAAKY,SAAL,GAAiB,IAAIA,SAAJ,CAAc,EAACa,YAAYzB,IAAb,EAAd,CAAjB;;AAEAA,iBAAKU,OAAL,GAAeA,OAAf;AACAA,oBAAQ6C,OAAR,CAAgB;AACZ,4BAAY,MADA;AAEZ,wBAAQ;AAFI,aAAhB;AAIH,SArFD;;AAuFA;AACA;AACA,YAAIC,UAAUC,SAASC,MAAT,GAAkBD,SAASE,QAAzC;AACAH,kBAAUA,QAAQI,OAAR,CAAgB,IAAhB,EAAqB,EAArB,CAAV;AACA,YAAIC,SAASL,QAAQM,KAAR,CAAc,GAAd,CAAb;AACA9D,aAAK6B,KAAL,GAAa,EAAb;AACA,YAAGgC,OAAO,CAAP,CAAH,EAAa;AAAC;AACV,gBAAIE,MAAM7D,eAAe8D,kBAAf,CAAkCH,OAAO,CAAP,CAAlC,CAAV;AACA,gBAAGE,GAAH,EAAO;AACH/D,qBAAK6B,KAAL,GAAakC,GAAb;AACH;AACJ;;AAED,cAAKE,SAAL;AACA,cAAKC,QAAL;AACA,cAAKC,sBAAL;;AAEA;AACA/D,UAAE,SAAF,EAAagE,EAAb,CAAgB,aAAhB,EAA+B,YAAU;AACrCC,oBAAQC,GAAR,CAAY,SAAZ;AACH,SAFD,EAEGF,EAFH,CAEM,cAFN,EAEqB,YAAU;AAC3BC,oBAAQC,GAAR,CAAY,UAAZ;AACH,SAJD,EAIGF,EAJH,CAIM,aAJN,EAIoB,YAAU;AAC1BC,oBAAQC,GAAR,CAAY,SAAZ;AACH,SAND,EAMGF,EANH,CAMM,eANN,EAMsB,YAAU;AAC5BC,oBAAQC,GAAR,CAAY,UAAZ;AACH,SARD;AAlIU;AA2Ib;;AAED;;;;;+BACM;AACF,gBAAIC,aAAanE,EAAE,oBAAF,EAAwBW,GAAxB,EAAjB;AACA,gBAAIyD,MAAMf,SAASC,MAAT,GAAkB,GAAlB,GAAwBa,UAAxB,GAAqC,OAArC,GAA8CrE,eAAeuE,kBAAf,CAAkC,KAAK5C,KAAvC,CAAxD;AACA4B,qBAASiB,IAAT,GAAgBF,MAAMf,SAASkB,MAA/B;AACH;;;oCAEU;AACP,gBAAI3E,OAAO,IAAX;AACA;AACAI,cAAE,iBAAF,EAAqBwE,KAArB,CAA2B,YAAU;AACjC;AACAnB,yBAASiB,IAAT,GAAgB,IAAhB;AACH,aAHD;AAIH;;;yCAEgBjC,I,EAAK;AAClB,gBAAIoC,MAAM,EAAV;AACA,gBAAIN,aAAanE,EAAE,oBAAF,EAAwBW,GAAxB,EAAjB;AACA,gBAAI+D,UAAU1E,EAAE,UAAF,EAAcW,GAAd,EAAd;AACA0B,iBAAKJ,OAAL,CAAa,UAASC,IAAT,EAAc;AACvBuC,uBAAO,eAAcN,UAAd,GAA2B,OAA3B,GAAsCjC,KAAKyC,cAA3C,GAA0D,OAA1D,IAAqED,UAAQ,cAAYA,OAApB,GAA4B,EAAjG,IAAsG,mCAAtG,GAA2IE,mBAAmB,2DAAyD1C,KAAK2C,OAA9D,GAAsE,MAAzF,CAA3I,GAA4O;;+BAA5O,GAEa3C,KAAK4C,WAFlB,GAEgC,0CAFhC,GAE2E5C,KAAK6C,UAFhF,GAE2F,iBAF3F,IAE8G7C,KAAK8C,QAAL,IAAiB,GAAjB,IAAwB,mCAAxB,IAA+D,EAF7K,IAEiL;mCAFjL,GAGiB9C,KAAK+C,UAHtB,GAGiC;qBAHjC,GAIG/C,KAAKgD,UAJR,GAIqB,GAJrB,GAI2BhD,KAAKiD,OAJhC,GAIyC,KAJzC,GAIiDjD,KAAKkD,QAJtD,GAIiE,GAJjE,GAIuElD,KAAKmD,IAJ5E,GAIkF;uDAJlF,IAMA,CAACnD,KAAKoD,OAAN,GAAc,EAAd,GAAiBpD,KAAKoD,OAAL,CAAaC,GAAb,CAAiB,UAASC,GAAT,EAAa;AAC9C,4BAAOA,GAAP;AACI,6BAAK,IAAL;AACA,mCAAO,wDAAP;AACA,6BAAK,IAAL;AACA,mCAAO,kDAAP;AACA,6BAAK,IAAL;AACA,mCAAO,mDAAP;AACA,6BAAK,MAAL;AACA,mCAAO,qDAAP;AACA;;AAEA,mCAAO,gBAAcA,GAAd,GAAkB,eAAzB;AAXJ;AAcH,iBAfmB,EAejBC,IAfiB,CAeZ,EAfY,CANjB,IAuBH;;0CAvBG,GAyB0BvD,KAAKwD,UAzB/B,GAyB4C,+DAzB5C,GAyB8GxD,KAAKyD,SAzBnH,GAyB+H;;;aAzBtI;AA6BH,aA9BD;;AAgCA,mBAAOlB,GAAP;AACH;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;wCAEgBpC,I,EAAK;AAAC;AAClB,gBAAIzC,OAAO,IAAX;AACA;AACI,gBAAGyC,QAAMA,KAAKrB,MAAd,EAAqB;AACjB,oBAAIyD,MAAM,EAAV;AACA,oBAAIN,aAAanE,EAAE,oBAAF,EAAwBW,GAAxB,EAAjB;AACA,oBAAI+D,UAAU1E,EAAE,UAAF,EAAcW,GAAd,EAAd;AACA0B,qBAAKJ,OAAL,CAAa,UAASC,IAAT,EAAc;AACvBA,yBAAKkC,GAAL,GAAW,MAAMD,UAAN,GAAmB,OAAnB,GAA6BjC,KAAKyC,cAAlC,GAAmD,OAAnD,IAA8DD,UAAQ,cAAYA,OAApB,GAA4B,EAA1F,CAAX;AACAxC,yBAAK0D,aAAL,GAAqBhB,mBAAmB,2DAAyD1C,KAAK2C,OAA9D,GAAsE,MAAzF,CAArB;;AAEAJ,2BAAO7E,KAAKY,SAAL,CAAeqF,GAAf,CAAmB3D,IAAnB,CAAP;AACH,iBALD;AAMA;AACAlC,kBAAE,OAAF,EAAW8F,MAAX,CAAkBrB,GAAlB;AACA7E,qBAAKmE,sBAAL;AACH,aAbD,MAaK,CAEJ,CAfD,CAaM;AACF;;AAER;AACH;;;qCAEW;AAAC;AACT/D,cAAE,UAAF,EAAc+F,IAAd;AACA/F,cAAE,cAAF,EAAkBgG,IAAlB,CAAuB,EAAvB;AACAhG,cAAE,iBAAF,EAAqB+F,IAArB,GAHQ,CAGoB;AAC/B;;;qCAEW;AACR/F,cAAE,UAAF,EAAciG,IAAd;AACH;;;qCAEW;AACRjG,cAAE,eAAF,EAAmBiG,IAAnB;AACH;;;iDAEuB;AAAC;AACrB,gBAAIC,WAAWlG,EAAE,kBAAF,EAAsBW,GAAtB,EAAf;AACA,gBAAIwD,aAAanE,EAAE,oBAAF,EAAwBW,GAAxB,EAAjB;AACA,gBAAII,SAASf,EAAE,gBAAF,EAAoBW,GAApB,EAAb;AACA,gBAAI+D,UAAU1E,EAAE,UAAF,EAAcW,GAAd,EAAd;AACA,gBAAIwF,QAAQnG,EAAE,iBAAF,CAAZ;AACA,gBAAIoG,cAAcpG,EAAE,cAAF,EAAkBW,GAAlB,EAAlB;AACA,gBAAGX,EAAE,0BAAF,EAA8BgB,MAA9B,IAAwC,CAAxC,IAA6CmF,MAAMnF,MAAN,GAAa,CAA7D,EAA+D;AAC3DhB,kBAAE,sBAAoB4E,mBAAmByB,KAAKC,SAAL,CAAe,EAACC,WAAW,SAAZ,EAAuBC,YAAW,EAACC,SAAS1F,MAAV,EAAlC,EAAf,CAAnB,CAApB,GAA6G,WAA7G,GAAyHoD,UAAzH,GAAoI,YAApI,IAAkJO,UAAQ,cAAYA,OAApB,GAA4B,EAA9K,IAAkL;;;yBAAlL,GAGYwB,QAHZ,GAGqB;;;iBAHvB,EAMOQ,WANP,CAMmB1G,EAAEmG,MAAM,CAAN,CAAF,EAAYQ,QAAZ,CAAqB,iBAArB,CANnB;AAOH;AACD,gBAAGP,eAAepG,EAAE,wBAAF,EAA4BgB,MAA5B,IAAsC,CAArD,IAA0DmF,MAAMnF,MAAN,GAAa,EAA1E,EAA6E;AACzEhB,kBAAE,sBAAoB4E,mBAAmByB,KAAKC,SAAL,CAAe,EAACC,WAAW,SAAZ,EAAuBC,YAAW,EAACC,SAAS1F,MAAV,EAAlC,EAAf,CAAnB,CAApB,GAA6G,WAA7G,GAAyHoD,UAAzH,GAAoI,UAApI,IAAgJO,UAAQ,cAAYA,OAApB,GAA4B,EAA5K,IAAgL;;;;;;iBAAlL,EAMOgC,WANP,CAMmB1G,EAAEmG,MAAM,EAAN,CAAF,EAAaQ,QAAb,CAAsB,iBAAtB,CANnB;AAOH;AACJ;;;oCAEU,CAEV,C,CAFW;;AAIZ;;;;mCACU;AACN,gBAAI/G,OAAO,IAAX;;AAEA;AACAI,cAAE,OAAF,EAAW8D,QAAX,CAAoB;AAChB8C,wBAAShH,KAAKgH,MAAL,CAAYf,GAAZ,CAAgBgB,IAAhB,CAAqBC,SADd;AAEhBC,2BAAW,WAFK;AAGhBC,mCAAoB,6BAAU;AAC1BpH,yBAAK6B,KAAL,IAAc,OAAO7B,KAAK6B,KAAL,CAAWwF,EAAhC;AACA,wBAAG,CAACrH,KAAK6B,KAAT,EAAe;AACX7B,6BAAK6B,KAAL,GAAa,EAAb;AACH;AACD,2BAAOzB,EAAEkB,MAAF,CAAS,EAAT,EAAYtB,KAAK6B,KAAjB,EAAuB,EAACV,QAAQf,EAAE,gBAAF,EAAoBW,GAApB,EAAT,EAAvB,CAAP;AACH,iBATe;AAUhBuG,6BAAa,MAVG;AAWhBC,2BAAY,EAXI;AAYhBC,0BAAU,EAZM;AAahBC,8BAAc,IAbE;AAchBC,6BAAa,IAdG;AAehBC,0BAAW,kBAASlF,IAAT,EAAe;;AAEtB,wBAAI,CAACA,KAAKA,IAAN,IAAc,CAACA,KAAKA,IAAL,CAAUmF,SAAzB,IAAsC,CAACnF,KAAKA,IAAL,CAAUmF,SAAV,CAAoBxG,MAA/D,EAAsE;AAClEqB,6BAAKoF,KAAL,GAAa,CAAb;AACA;AACH;;AAED7H,yBAAK8H,eAAL,CAAqBrF,KAAKA,IAAL,CAAUmF,SAA/B;AACH;AAvBe,aAApB;AAyBH;;;;EAzTwBG,U;AA2T7B;;;;;AAGA3H,EAAE4H,QAAF,EAAYC,KAAZ,CAAkB,YAAW;AACzB,QAAIlI,cAAJ;AACH,CAFD","file":"list.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n 1. 项目名称：悟空找房h5\r\n 2. 页面名称：esf/list(二手房列表)\r\n 3. 作者：zhaohuagang@lifang.com\r\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\nclass ListController extends Controller {\r\n    constructor() {        \r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        类的初始化，继承控制器基类\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        super() ;        \r\n        var self = this;        \r\n        this.paramGenerator = new ParamGenerator();\r\n        setTimeout(function(){\r\n            $('.total').slideDown(function(){\r\n                setTimeout(function(){\r\n                    $('.total').slideUp();\r\n                },2000);\r\n            });// 隐藏查询总条数   \r\n        },100);   \r\n        \r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        图片懒加载实例化\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/        \r\n        $(\".lazy\").lazyload({ \r\n            \"placeholder\" : this.staticDomain + \"/wkh5_fe/images/common/loading.jpg\"\r\n        }) ;\r\n        \r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        加载相关页面组件逻辑\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        require([ \"../components/bigdata.min\" , \"../components/filter.min\", \"../components/async-item.min\", \"../components/conning-tower.min\" ] , (BigData, Filter, AsyncItem) => {\r\n            BigData.init(this) ;\r\n\r\n            // 城市不同总价选项不同，XFDEFAULT中prices是北京、上海、广州、深圳、杭州、苏州、廊坊、南京的价格选项，比较高，\r\n            // 因此需要区分\r\n            /*\r\n            *   北京\t3\r\n                上海\t43\r\n                广州\t1873\r\n                深圳\t1950\r\n                杭州\t873\r\n                苏州\t771\r\n                廊坊\t221\r\n                南京\t741\r\n            */\r\n\r\n            var visitedCityId = $('#visitedCityId').val();\r\n            var highPriceCityIds = [3,43,1873,1950,873,771,221,741];\r\n            var prices = highPriceCityIds.filter(function(cityId){return cityId == visitedCityId }).length == 0 ? Filter.LOWPRICES : null;\r\n\r\n            self.filter = new Filter($.extend({}, Filter.ESFDEFAULT,{\r\n                el: \".filter\",                \r\n                cityId: $('#visitedCityId').val(),                \r\n                BigData: BigData,                \r\n                controller: self,\r\n                near: true,\r\n                filterChanged: function(result){                         \r\n                    var param = self.paramGenerator.generateParamObj(result);\r\n                    if(param.di || param.to || param.li || param.st || result.DistrictAndMetroUnlimited){\r\n                        // do nothing\r\n                    }else{// 判断是否有sid,sli,sst,sdi,sto\r\n                        var mapping = [\"sdi\",\"sto\",\"sli\",\"sst\",\"sid\"];\r\n                        mapping.forEach(function(item){\r\n                            if(self.param[item]){\r\n                                param[item] = self.param[item];\r\n                            }\r\n                        });                        \r\n                    }\r\n                    \r\n\r\n                    self.param = param;\r\n                    // 跳转\r\n                    self.goto();\r\n                }                \r\n            },prices));\r\n            new ConningTower({                \r\n                \"bigDataUtil\" : BigData ,               \r\n                \"moduleType\" : \"esf\" ,\r\n                \"cityClick\" : () => {\r\n                    \r\n                } ,                \r\n                \"searchResultItemClick\" : (data) => {\r\n                    // 与filter中的区域地铁互斥\r\n                    delete self.param.di;// 区域id\r\n                    delete self.param.to;// 板块id\r\n                    delete self.param.li;// 地铁线id\r\n                    delete self.param.st;// 地铁站id\r\n                    delete self.param.id;// 小区id\r\n                    delete self.param.sdi;// 区域id\r\n                    delete self.param.sto;// 板块id\r\n                    delete self.param.sli;// 地铁线id\r\n                    delete self.param.sst;// 地铁站id\r\n                    delete self.param.sid;// 小区id\r\n                    delete self.param.lat;\r\n                    delete self.param.lon;\r\n                    delete self.param.m;\r\n                    var mapping = [\"\",\"sdi\",\"sto\",\"sli\",\"sst\",\"sid\"];\r\n                    var key = mapping[data.type];\r\n                    if(key){\r\n                        self.param[key] = data.value;\r\n                        self.goto();\r\n                    }\r\n                },\r\n                \"locationCallback\": (data)=>{\r\n                    self.filter.setLocationInfo(data);\r\n                }\r\n            }) ;\r\n\r\n            self.AsyncItem = new AsyncItem({controller: self});\r\n\r\n            self.BigData = BigData;\r\n            BigData.bigData({\r\n                \"pageName\": \"1068\",                       \r\n                \"type\": 1\r\n            });\r\n        }) ;\r\n\r\n        // 从url中解析参数\r\n        //var pageUrl = location.href;\r\n        var pageUrl = location.origin + location.pathname;\r\n        pageUrl = pageUrl.replace('//','');\r\n        var tmpArr = pageUrl.split('/');\r\n        self.param = {};\r\n        if(tmpArr[3]){// 有查询条件\r\n            var obj = ParamGenerator.queryString2Object(tmpArr[3]);\r\n            if(obj){\r\n                self.param = obj;\r\n            }\r\n        }                            \r\n\r\n        this.bindEvent();\r\n        this.pullload();\r\n        this.insertTrendAndOldHouse();\r\n\r\n        // 测试filter事件\r\n        $('.filter').on('show.filter', function(){\r\n            console.log('show...');\r\n        }).on('shown.filter',function(){\r\n            console.log('shown...');\r\n        }).on('hide.filter',function(){\r\n            console.log('hide...');\r\n        }).on('hidden.filter',function(){\r\n            console.log('hiden...');\r\n        });\r\n    }        \r\n\r\n    // 根据查询条件进行相应的跳转\r\n    goto(){\r\n        var cityPinyin = $('#visitedCityPinyin').val();\r\n        var url = location.origin + \"/\" + cityPinyin + \"/esf/\" +ParamGenerator.object2QueryString(this.param);\r\n        location.href = url + location.search;\r\n    }\r\n\r\n    bindEvent(){\r\n        var self = this;\r\n        // 清空查询条件\r\n        $('.no-data button').click(function(){\r\n            // 跳转            \r\n            location.href = \"./\";\r\n        });\r\n    }\r\n    \r\n    createHouseItems(data){\r\n        var str = \"\";\r\n        var cityPinyin = $('#visitedCityPinyin').val();\r\n        var channel = $('#channel').val();\r\n        data.forEach(function(item){            \r\n            str += '<a href=\"/'+ cityPinyin + '/esf/' +  item.encryptHouseId+'.html' + (channel?'?channel='+channel:'') +'\" class=\"esf-item\" data-bigdata=\"'+ encodeURIComponent('{\"eventName\": \"1068028\", \"eventParam\": { \"house_id\": \"'+item.houseId+'\" }}')+'\">\\\r\n            <dl>\\\r\n                <dt><img src=\"'+item.houseImgUrl + '?x-oss-process=image/resize,w_150\" alt=\"'+item.estateName+'\" class=\"lazy\">'+(item.hasVideo == '1' && '<span class=\"play\"><i></i></span>' || '')+'</dt>\\\r\n                <dd class=\"title\">'+item.houseTitle+'</dd>\\\r\n                <dd>'+item.houseChild + \" \" + item.areaStr +' | ' + item.district + \" \" + item.town +' </dd>\\\r\n                <dd class=\"tags\"><div class=\"wk-tags\">'\r\n                + (!item.tagList?\"\":item.tagList.map(function(tag){\r\n                    switch(tag){\r\n                        case \"降价\":\r\n                        return '<div class=\"highlight promotion\"><span>降价</span></div>';\r\n                        case \"新上\":\r\n                        return '<div class=\"highlight new\"><span>新上</span></div>';\r\n                        case \"满二\":\r\n                        return '<div class=\"highlight over\"><span>满二</span></div>';\r\n                        case \"满五唯一\":\r\n                        return '<div class=\"highlight over\"><span>满五唯一</span></div>';\r\n                        default:\r\n\r\n                        return '<div><span>'+tag+'</span></div>';\r\n                    }\r\n                    \r\n                }).join('') )\r\n                +                                  \r\n                '</div></dd>\\\r\n                <dd>\\\r\n                     <span class=\"money\">' + item.totalPrice + '</span> <span class=\"unit\">万</span>&nbsp;<span class=\"price\">' + item.unitPrice + ' 元/㎡</span>\\\r\n                </dd>\\\r\n            </dl>\\\r\n        </a>';\r\n        });\r\n\r\n        return str;\r\n    }    \r\n\r\n    // createHouseList(data,count){// 生成房源列表\r\n    //     this.hideNoData();\r\n    //     if(data && data.length){\r\n    //         $('.no-data').hide();\r\n    //         var str = this.createHouseItems(data);\r\n\r\n    //         $('#list').html(str);\r\n    //         $('.total .count').text(count);\r\n    //         $('.total').slideDown();\r\n    //         setTimeout(function(){\r\n    //             $('.total').slideUp();\r\n    //         }, 1500);\r\n\r\n    //         this.insertTrendAndOldHouse();\r\n    //     }else{// 没数据\r\n    //         this.showNoData();\r\n    //     }\r\n    // }\r\n\r\n    appendHouseList(data){// 上拉滚动时加载数据\r\n        let self = this;\r\n        //require(['../components/async-item.min'], function(AsyncItem){\r\n            if(data&&data.length){\r\n                var str = \"\";\r\n                var cityPinyin = $('#visitedCityPinyin').val();\r\n                var channel = $('#channel').val();\r\n                data.forEach(function(item){\r\n                    item.url = \"/\" + cityPinyin + \"/esf/\" + item.encryptHouseId + \".html\" + (channel?'?channel='+channel:'');             \r\n                    item.bigDataParams = encodeURIComponent('{\"eventName\": \"1068028\", \"eventParam\": { \"house_id\": \"'+item.houseId+'\" }}');\r\n\r\n                    str += self.AsyncItem.esf(item);\r\n                });\r\n                //var str = this.createHouseItems(data);\r\n                $('#list').append(str);\r\n                self.insertTrendAndOldHouse();\r\n            }else{// 没有更多数据了\r\n                //this.showNoMore();\r\n            }\r\n        //});        \r\n    }\r\n\r\n    showNoData(){// 显示没有数据，并显示新房楼盘推荐\r\n        $('.no-data').show();\r\n        $('.total + div').html('');\r\n        $('.recommendation').show();// TODO:显示推荐楼盘\r\n    }\r\n\r\n    hideNoData(){\r\n        $('.no-data').hide();\r\n    }\r\n\r\n    hideNoMore(){\r\n        $('.reach-bottom').hide();\r\n    }\r\n\r\n    insertTrendAndOldHouse(){// 场景连篇       \r\n        var cityName = $('#visitedCityName').val();\r\n        var cityPinyin = $('#visitedCityPinyin').val();\r\n        var cityId = $('#visitedCityId').val();\r\n        var channel = $('#channel').val();\r\n        var $list = $('#list .esf-item');\r\n        var newBusiness = $('#newBusiness').val();\r\n        if($('#list .scene.house-price').length == 0 && $list.length>9){\r\n            $('<a data-bigdata=\"'+encodeURIComponent(JSON.stringify({eventName: \"1068074\", eventParam:{city_id: cityId}}))+'\" href=\"/'+cityPinyin+'/trend/esf'+(channel?\"?channel=\"+channel:\"\")+'\" class=\"scene house-price\">\\\r\n                <div class=\"img\"></div>\\\r\n                <div class=\"info\">\\\r\n                    <h3>'+cityName+'房价涨了还是跌了？</h3>\\\r\n                    <span class=\"detail\">去看看</span>\\\r\n                </div>\\\r\n            </a>').insertAfter($($list[9]).addClass('remove-baseline'));\r\n        }\r\n        if(newBusiness && $('#list .scene.new-house').length == 0 && $list.length>19){\r\n            $('<a data-bigdata=\"'+encodeURIComponent(JSON.stringify({eventName: \"1068075\", eventParam:{city_id: cityId}}))+'\" href=\"/'+cityPinyin+'/xflist/'+(channel?\"?channel=\"+channel:\"\")+'\" class=\"scene new-house\">\\\r\n                <div class=\"img\"></div>\\\r\n                <div class=\"info\">\\\r\n                    <h3>火爆高性价比新房</h3>\\\r\n                    <span class=\"detail\">去看看</span>\\\r\n                </div>\\\r\n            </a>').insertAfter($($list[19]).addClass('remove-baseline'));\r\n        }\r\n    }\r\n\r\n    showError(){// 接口报错，分为两种，1. 筛选条件变更刷新 2. 上拉加载\r\n\r\n    }\r\n\r\n    // 上拉加载\r\n    pullload(){\r\n        let self = this ;\r\n\r\n        //二手房\r\n        $(\"#list\").pullload({\r\n            apiUrl : self.apiUrl.esf.list.houselist ,\r\n            itemClass: \".esf-item\",\r\n            queryStringObject : function(){\r\n                self.param && delete self.param.pa;\r\n                if(!self.param){\r\n                    self.param = {};\r\n                }\r\n                return $.extend({},self.param,{cityId: $('#visitedCityId').val()});\r\n            },   \r\n            requestType: \"POST\",\r\n            threshold : 50 ,\r\n            pageSize: 10,   \r\n            pageIndexKey: \"of\",\r\n            pageSizeKey: \"ps\",    \r\n            callback : function(data) {\r\n                \r\n                if( !data.data || !data.data.houseList || !data.data.houseList.length){\r\n                    data.count = 1;\r\n                    return;    \r\n                } \r\n\r\n                self.appendHouseList(data.data.houseList);                \r\n            }\r\n        }) ;\r\n    }\r\n}\r\n/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n类的初始化\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n$(document).ready(function() {\r\n    new ListController ;\r\n}) ;"]}
{"version":3,"sources":["esf/detail.min.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","DetailController","_Controller","this","_this","getPrototypeOf","$","lazyload","placeholder","staticDomain","addListenerToDownloadApp","WakeupApp","element","androidSchemes","val","isoSchemes","androidDownloadLink","iosDownloadLink","addListenerToAssistant","fiveLine","encryptsubestateid","attr","that","request","apiUrl","community","chart","subEstateId","successCallback","data","status","dataRes","echartData","recombineM","echartFun","require","Album","BigData","init","bigData","pageName","pageParam","house_id","boutique","channel","GetRequest","type","hide","rowNum","Math","round","height","parseFloat","css","addClass","show","removeClass","click","monthList","seriesData","forEach","item","month","date","split","indexOf","push","charAt","unitPrice","sortArray","sort","a","b","maxPrice","ceil","myChart","echarts","document","getElementById","width","houseId","subestateid","echartBigData","eventName","eventParam","estate_id","option","tooltip","trigger","triggerOn","position","backgroundColor","padding","textStyle","color","fontSize","formatter","params","ticket","callback","paramsValue","common","grid","bottom","left","right","containLabel","xAxis","splitLine","axisTick","boundaryGap","axisLine","lineStyle","axisLabel","interval","rotate","fontFamily","yAxis","inside","index","min","max","splitNumber","series","name","normal","itemStyle","emphasis","borderColor","borderWidth","setOption","url","location","search","theRequest","str","substr","strs","Controller","ready"],"mappings":"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","file":"detail.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n 1. 项目名称：悟空找房h5\n 2. 页面名称：esf/detail(二手房-详情)\n 3. 作者：liyang@lifang.com\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\nclass DetailController extends Controller {\n    constructor() {        \n        // 初始化\n        super() ;        \n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        图片懒加载实例化\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/        \n        $(\".lazy\").lazyload({ \n            \"placeholder\" : this.staticDomain + \"/wkh5_fe/images/common/loading.jpg\"\n        }) ;  \n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        downloadApp条事件绑定\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        this.addListenerToDownloadApp() ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        打开app按钮点击处理\n        schemes参数规则请参照：http://confluence.wkzf/pages/viewpage.action?pageId=80329073\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        new WakeupApp({\n            element : \".download-app .download\" ,\n            androidSchemes : \"wkzf://external_call/parameter?t=0&bt=1&houseId=\" + $(\"#houseId\").val() + \"&systemHouseType=1\" ,\n            isoSchemes : \"wkzf://external_call/parameter?t=0&bt=1&houseId=\" + $(\"#houseId\").val() + \"&systemHouseType=1\" ,\n            androidDownloadLink : \"https://m.wkzf.com/download/transit?from=esfDetail\" ,\n            iosDownloadLink : \"https://m.wkzf.com/download/transit?from=esfDetail\"\n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        底部经纪人助手条处理\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        this.addListenerToAssistant() ;\n\n         this.fiveLine() ;         \n        // 获取小区加密Id\n        let  encryptsubestateid = $('#estateName').attr('data-encryptsubestateid');\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        请求接口 获取折线图参数\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n         let that = this;\n         this.request(this.apiUrl.community.chart,{subEstateId:encryptsubestateid},{successCallback(data){\n             if (data.status == 1){\n                 let dataRes = data;\n                 let echartData =  that.recombineM(dataRes.data);\n                 that.echartFun(echartData) ;\n             }\n          }});\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        页面埋点和相册需要的模块\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        let self = this;\n        require([ '../components/album.min','../components/bigdata.min'],function(Album, BigData){\n            BigData.init(that);\n            BigData.bigData({\n                \"pageName\": \"1067\",\n                \"pageParam\":{\n                    \"house_id\": $('#estateName').attr('data-houseid'),\n                    \"boutique\": $('#estateName').attr('data-boutique')\n                },\n                \"channel\":self.GetRequest()['channel'] || \"\",\n                \"type\": 1\n            });\n        });\n    }        \n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    判断文本是否大于5行\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    fiveLine(){\n        $('.more').hide();\n        let rowNum=Math.round($(\".base-info\").height()/parseFloat($(\".base-info\").css('line-height')));\n        if(rowNum > 5){\n            $(\".base-info\").addClass('word-line');\n            $('.more').show();\n        }else {\n            $(\".base-info\").removeClass('word-line');\n            $('.more').hide();\n        }\n        $('.more').click(function () {\n            $(\".base-info\").removeClass('word-line');\n            $('.more').hide();\n        });\n    }\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    处理得到的数据的函数  处理月份和数据\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    recombineM(data) {\n        let echartData = {\n            monthList: [],\n            seriesData: []\n        };\n        if (data) {\n            data.forEach((item) => {\n                let month = item.date.split('-')[1];\n                if (month.indexOf('0') == 0) {\n                    echartData.monthList.push(month.charAt(1)+'月')\n                } else {\n                    echartData.monthList.push(month+'月')\n                }\n                echartData.seriesData.push(item.unitPrice)\n            });\n        }\n        return echartData ;\n    }\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n   折线图函数异步操作\n   -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    echartFun(echartData){\n        let sortArray = echartData.seriesData.sort(function(a, b) {\n            return parseFloat(a) - parseFloat(b);\n        });\n        let maxPrice = Math.ceil((sortArray[sortArray.length - 1] / 10000) + 1) * 10000;\n        let myChart = echarts.init(document.getElementById('main'),{ width: '88%' });\n        let that = this;\n        // 给折线图dome增加埋点\n        let houseId =  $('#estateName').attr('data-houseid');\n        let subestateid =  $('#estateName').attr('data-subestateid') ;\n        let echartBigData = {\n            \"eventName\": \"1067014\",\n            \"eventParam\": { \"house_id\" : houseId , \"estate_id\": subestateid },\n            \"type\": 2\n        };\n        // 指定图表的配置项和数据\n        let option = {\n            tooltip: {      // 提示框\n                trigger: 'item',\n                triggerOn: 'click',\n                position: 'top',\n                backgroundColor: '#92A7C3',\n                padding: 4,\n                textStyle: {\n                    color: '#fff',\n                    fontSize: '12'\n                },\n                formatter:function (params, ticket, callback) {\n                    let paramsValue =  params.value + \"元\";\n                    that.request(that.apiUrl.common.bigData , echartBigData ,function () {\n\n                    });\n                    return paramsValue;\n                }\n            },\n            grid: {\n                bottom: 20,\n                left: '3%',\n                right: '10%',\n                containLabel: true,\n            },\n            xAxis: {\n                data: echartData.monthList ,  // X坐标数据\n                splitLine: {show: false}, // 控制网格线是否显示\n                axisTick: {show: false},  // 去除x轴上的刻度线\n                position: 'bottom',\n                type: 'category',\n                boundaryGap: false,\n                axisLine: {\n                    lineStyle: {\n                        color: '#979797', // x轴颜色\n                    }\n                },\n                axisLabel: {\n                    interval: 0,\n                    rotate: 0, //60度角倾斜显示\n                    textStyle: {\n                        color: '#999',\n                        fontSize: 12,\n                        fontFamily: '微软雅黑'\n                    }\n                },\n            },\n            yAxis: {\n                axisLine: {show: false},   // y轴是否显示\n                splitLine: {\n                    show: true,  // 控制网格线是否显示\n                    lineStyle: {\n                        color: ['#979797'] // y刻度颜色\n                    }\n                },\n                axisTick: {show: false},// 去除y轴上的刻度线\n                axisLabel:{\n                    inside: false,\n                    textStyle: {\n                        color: '#999',\n                    },\n                    formatter: function(value, index) {\n                        if (value == 0) {\n                            return \"\";\n                        } else {\n                            return value / 10000 + '万';\n                        }\n                    }\n                },\n                min:0,\n                max:maxPrice,\n                splitNumber: 4,\n                interval: maxPrice / 4\n            },\n            series: [{\n                name: '销量',\n                type: 'line',\n                lineStyle:{\n                    normal:{\n                        color:'#92A7C3', // 折线条颜色\n                    }\n\n                },\n                itemStyle:{\n                    normal:{\n                        color: \"#92A7C3\" //图标颜色\n                    },\n                    emphasis: { //重点，强调时候的样式，即当鼠标悬停或点击上去的时候的拐点的样式\n                        borderColor: '#92A7C3',\n                        borderWidth: 2,\n                        color: '#92A7C3'\n                    }\n                },\n                data: echartData.seriesData,\n\n            }],\n        };\n        myChart.setOption(option);\n    }\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n     截取？后面的参数\n     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    GetRequest() {\n        let url = location.search;\n        let theRequest = {};\n        if (url.indexOf(\"?\") !== -1) {\n            let str = url.substr(1);\n            let strs = str.split(\"&\");\n            for(var i = 0; i < strs.length; i ++) {\n                theRequest[strs[i].split(\"=\")[0]]=strs[i].split(\"=\")[1];\n            }\n        }\n        // console.log(theRequest);\n        return theRequest;\n    }\n}\n\n\n/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n类的初始化\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n$(document).ready(function() {\n    new DetailController;\n});"]}
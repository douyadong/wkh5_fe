"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),IndexController=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));$(".lazy").lazyload({placeholder:e.staticDomain+"/wkh5_fe/images/common/loading.jpg"}),$(".wk-tabs .tabs-handle li").eq(0).addClass("on");var a=e;e.byIdGetPosition();var n={longitude:e.getLocation().longitude,latitude:e.getLocation().latitude};return e.request(e.apiUrl.store.house,{storeId:$("#storeId").val(),pageIndex:0,pageSize:20,lon:n.longitude,lat:n.latitude},{successCallback:function(e){e.data&&e.data.length>0?e.data.forEach(function(e,t){e.bigDataParams=encodeURIComponent(JSON.stringify({eventName:1222001,eventParam:{store_id:$("#storeId").val(),house_id:e.houseId}})),e.url="/"+$("#cityPinYin").val()+"/esf/"+e.encryptHouseId+".html?storeId="+$("#storeId").val(),$(".tabs-frame.esf-items .list-container").append(a.createEsf(e))}):$(".nodata-store").show()}}),require(["../components/bigdata.min","../components/tabs.min"],function(t){t.init(e),t.bigData({pageName:"1222",pageParam:{store_id:$("#storeId").val()},type:1}),$(".wk-tabs").tabs({fixedWhenScroll:!1,effect:"fadeIn",duration:200,onSwap:function(e){$(".tabs-frame .list-container").attr("data-requestable","false"),$(".tabs-frame").eq(e).find(".list-container").attr("data-requestable","true"),$("html,body").animate({scrollTop:"0px"},100)}})}),e.addEventListener(),e.pullload(),e}return _inherits(t,e),_createClass(t,[{key:"addEventListener",value:function(){$(".icon-back").on("click",function(){window.location.href="/"}),$(window).on("scroll",function(){var e=$("header"),t=$("header .banner .store-name");$(window).scrollTop()>=20?(e.hasClass("fixed")||e.addClass("fixed"),$(".market").addClass("market-small"),$(".tabs-frame").addClass("header-margin"),t.hide()):$(window).scrollTop()<20&&(e.hasClass("fixed")&&e.removeClass("fixed"),$(".market").removeClass("market-small"),$(".tabs-frame").removeClass("header-margin"),t.show())}),$(".tabs-frame.agent-items .wechat").click(function(){$.modal({id:"addWechatModal",title:"扫码加微信",content:'<img src="'+$(this).data("agentwchartqrimgurl")+'" style="width : 12rem ; height : 12rem ; "><p>微信号：'+$(this).data("agentwchatid")+"</p>",buttons:[{text:"确定",clickCallback:function(){$.modal.close("addWechatModal")}}]})})}},{key:"createEsf",value:function(e){var t=$(document.createElement("A")).attr("href",e.url).attr("data-bigdata",e.bigDataParams).addClass("esf-item"),a=$(document.createElement("DL"));a.append('<dt><img src="'+e.houseImgUrl+'?x-oss-process=image/resize,w_150" alt="'+e.estateName+'" class="lazy"></dt>'),a.append('<dd class="title">'+e.houseTitle+"</dd>"),a.append("<dd>"+e.houseChild+" "+e.areaStr+" | "+e.district+" "+e.town+"</dd>");var n=$(document.createElement("DD")).addClass("tags");return e.tagList&&e.tagList.forEach(function(e){"降价"==e?n.append('<div class="promotion"><span>'+e+"</span></div>"):"新上"==e?n.append('<div class="new"><span>'+e+"</span></div>"):"满二"==e||"满五唯一"==e?n.append('<div class="over"><span>'+e+"</span></div>"):n.append("<div><span>"+e+"</span></div>")}),a.append(n),a.append('<dd><span class="money">'+e.totalPrice+'万</span> <span class="price">'+e.unitPrice+" 元/㎡</span></dd>"),t.append(a),t}},{key:"pullload",value:function(){var e=this;$(".tabs-frame.esf-items .list-container").pullload({apiUrl:this.apiUrl.store.house,queryStringObject:{storeId:$("#storeId").val()},threshold:50,callback:function(t){t.data&&$.each(t.data,function(t,a){a.url="/"+$("#cityPinYin").val()+"/esf/"+a.encryptHouseId+".html?storeId="+$("#storeId").val(),$(".tabs-frame.esf-items .list-container").append(e.createEsf(a))})}})}},{key:"byIdGetPosition",value:function(){console.log("进入函数"),this.request(this.apiUrl.store.wxmpStore,{storeId:$("#storeId").val()},{successCallback:function(e){console.log(JSON.stringify(e))}})}},{key:"getLocation",value:function(){if(!navigator.geolocation)return void $.tips("您的浏览器不支持定位地理位置",3);var e={enableHighAccuracy:!1,maximumAge:0,timeout:1e4},t={latitude:null,longitude:null};return console.log("没有进去定位"),navigator.geolocation.getCurrentPosition(function(e){t.latitude=e.coords.latitude,t.longitude=e.coords.longitude,console.log("进入定位"),console.log(t)},function(e){switch(e.code){case e.PERMISSION_DENIED:break;case e.POSITION_UNAVAILABLE:$.tips("定位信息无效",3);break;case e.TIMEOUT:$.tips("定位超时",3);break;case e.UNKNOWN_ERROR:}},e),t}}]),t}(Controller);$(document).ready(function(){new IndexController});
//# sourceMappingURL=index.min.js.map

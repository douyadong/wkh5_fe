{"version":3,"sources":["store/index.min.js"],"names":["IndexController","$","lazyload","staticDomain","eq","addClass","self","byIdGetPosition","locationPo","longitude","getLocation","latitude","request","apiUrl","store","house","val","lon","lat","successCallback","result","data","length","forEach","item","index","bigDataParams","encodeURIComponent","JSON","stringify","houseId","url","encryptHouseId","append","createEsf","show","require","BigData","init","bigData","tabs","attr","find","animate","scrollTop","addEventListener","pullload","on","window","location","href","$header","$storeName","hasClass","hide","removeClass","click","modal","close","esf","aNode","document","createElement","dlNode","houseImgUrl","estateName","houseTitle","houseChild","areaStr","district","town","tagNode","tagList","tag","totalPrice","unitPrice","queryStringObject","threshold","callback","each","console","log","wxmpStore","navigator","geolocation","tips","geoOpts","enableHighAccuracy","maximumAge","timeout","getCurrentPosition","position","coords","error","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","Controller","ready"],"mappings":"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","file":"index.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n 1. 项目名称：悟空找房h5\r\n 2. 页面名称：store -> index(门店扫码)\r\n 3. 作者：douyadong@lifang.com\r\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\nclass IndexController extends Controller{\r\n    constructor(){\r\n        super() ;\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        图片懒加载实例化\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/        \r\n        $(\".lazy\").lazyload({ \r\n            \"placeholder\" : this.staticDomain + \"/wkh5_fe/images/common/loading.jpg\"\r\n        }) ;  \r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        给第一个tabs-handle选项添加on样式\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/         \r\n        $(\".wk-tabs .tabs-handle li\").eq(0).addClass(\"on\") ;\r\n        let self = this;\r\n        this.byIdGetPosition();\r\n        let locationPo ={\r\n            longitude:this.getLocation().longitude  ,\r\n            latitude: this.getLocation().latitude\r\n        };\r\n        this.request(this.apiUrl.store.house,{ \"storeId\" : $(\"#storeId\").val() , \"pageIndex\" : 0 , 'pageSize' : 20 ,lon:locationPo.longitude,lat:locationPo.latitude},{\r\n            successCallback(result){\r\n                if (result.data && result.data.length >0){\r\n                    result.data.forEach((item,index)=>{\r\n                        item.bigDataParams = encodeURIComponent(JSON.stringify( { \"eventName\" : 1222001 , \"eventParam\" : { \"store_id\" : $(\"#storeId\").val() , \"house_id\" : item.houseId } } )) ;\r\n                        item.url = \"/\" + $(\"#cityPinYin\").val() + \"/esf/\" + item.encryptHouseId + \".html\"+\"?storeId=\"+$(\"#storeId\").val() ;\r\n                        $(\".tabs-frame.esf-items .list-container\").append(self.createEsf(item)) ;\r\n                    })\r\n                }else {\r\n                    $('.nodata-store').show()\r\n                }\r\n            }\r\n        });\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        载入组件逻辑\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/ \r\n        require([ \"../components/bigdata.min\"  ,\"../components/tabs.min\"] , (BigData)=>{\r\n            /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n            pv埋点\r\n            -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n            BigData.init(this) ;\r\n            BigData.bigData({\r\n                \"pageName\" : \"1222\" ,\r\n                \"pageParam\" : {                    \r\n                    \"store_id\" : $(\"#storeId\").val()\r\n                } ,\r\n                \"type\" : 1\r\n            }) ;\r\n            /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n            tabs实例化,onSwap的时候要将切换到的tab的拖动加载容器requestable设置为true，其他tab拖动加载容器设置为false\r\n            -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n            $(\".wk-tabs\").tabs({\r\n                \"fixedWhenScroll\" : false ,\r\n                \"effect\" : \"fadeIn\" ,\r\n                \"duration\" : 200 ,\r\n                 \"onSwap\" : (index)=> {\r\n                    $(\".tabs-frame .list-container\").attr( \"data-requestable\" , \"false\" ) ;\r\n                    $(\".tabs-frame\").eq(index).find(\".list-container\").attr( \"data-requestable\" , \"true\" ) ;\r\n                    $(\"html,body\").animate({\r\n                        scrollTop : \"0px\"\r\n                    } , 100) ;\r\n                }\r\n            }) ;\r\n        }) ;\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        给dom节点绑定事件\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        this.addEventListener() ;\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        上拉加载实例化\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        this.pullload() ;\r\n    }\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    给dom节点绑定事件\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    addEventListener() {\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        点返回按钮要返回M站首页\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/        \r\n        $('.icon-back').on('click',function(){\r\n            window.location.href = \"/\" ;\r\n        }) ;\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        页面滚动的时候banner条的变动\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        $(window).on(\"scroll\" , ()=> {\r\n            let $header = $(\"header\") ;\r\n            let $storeName = $(\"header .banner .store-name\") ;\r\n            if ($(window).scrollTop() >= 20 ) {                \r\n                if( ! $header.hasClass(\"fixed\")) $header.addClass(\"fixed\") ;\r\n                $('.market').addClass('market-small');\r\n                $(\".tabs-frame\").addClass(\"header-margin\") ;           \r\n                $storeName.hide() ;\r\n            }\r\n            else if ($(window).scrollTop() < 20) {\r\n                if( $header.hasClass(\"fixed\") ) $header.removeClass(\"fixed\") ;\r\n                $('.market').removeClass('market-small');\r\n                $(\".tabs-frame\").removeClass(\"header-margin\") ; \r\n                $storeName.show() ;\r\n            }\r\n        }) ; \r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        添加微信按钮事件绑定\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        $(\".tabs-frame.agent-items .wechat\").click(function(){\r\n            $.modal({\r\n                \"id\" : \"addWechatModal\" ,\r\n                \"title\" : \"扫码加微信\" ,\r\n                \"content\" : \"<img src=\\\"\" + $(this).data(\"agentwchartqrimgurl\") + \"\\\" style=\\\"width : 12rem ; height : 12rem ; \\\"><p>微信号：\" + $(this).data(\"agentwchatid\") + \"</p>\" ,\r\n                \"buttons\" : [\r\n                    { \"text\" : \"确定\"  , \"clickCallback\" : function(){ $.modal.close(\"addWechatModal\") ; } }               \r\n                ]\r\n            }) ;            \r\n        }) ;       \r\n    } ;\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    绘制单条房源dom节点的方法，请参照ejs模板内容\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    createEsf(esf) {\r\n        let aNode = $(document.createElement(\"A\")).attr( \"href\" , esf.url ).attr( \"data-bigdata\" , esf.bigDataParams).addClass(\"esf-item\") ;\r\n        let dlNode = $(document.createElement(\"DL\")) ;\r\n        dlNode.append( \"<dt><img src=\\\"\" + esf.houseImgUrl + \"?x-oss-process=image/resize,w_150\\\" alt=\\\"\" + esf.estateName + \"\\\" class=\\\"lazy\\\"></dt>\" ) ;\r\n        dlNode.append( \"<dd class=\\\"title\\\">\" + esf.houseTitle + \"</dd>\" ) ;\r\n        dlNode.append( \"<dd>\" + esf.houseChild +\" \" + esf.areaStr + \" | \" +  esf.district + \" \" + esf.town + \"</dd>\" ) ;              \r\n        let tagNode = $(document.createElement(\"DD\")).addClass(\"tags\") ;\r\n        esf.tagList && esf.tagList.forEach((tag) => {\r\n            if(tag == \"降价\") {\r\n                tagNode.append( `<div class=\"promotion\"><span>${ tag }</span></div>`) ;\r\n            }else if (tag == \"新上\"){\r\n                tagNode.append( `<div class=\"new\"><span>${ tag }</span></div>`) ;\r\n            }else if(tag == \"满二\" || tag == \"满五唯一\"){\r\n                tagNode.append( `<div class=\"over\"><span>${ tag }</span></div>`) ;\r\n            }else  {\r\n                tagNode.append( `<div><span>${ tag }</span></div>`) ;\r\n            }\r\n        }) ;        \r\n        dlNode.append(tagNode) ;\r\n        dlNode.append( \"<dd><span class=\\\"money\\\">\" + esf.totalPrice+ \"万</span> <span class=\\\"price\\\">\" + esf.unitPrice + \" 元/㎡</span></dd>\" ) ;  \r\n        aNode.append(dlNode) ;\r\n        return aNode ;\r\n    } ;    \r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    上拉加载实例化\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    pullload() {\r\n        let self = this ;\r\n        //二手房\r\n        $(\".tabs-frame.esf-items .list-container\").pullload({\r\n            apiUrl : this.apiUrl.store.house ,\r\n            queryStringObject : { \"storeId\" : $(\"#storeId\").val() } ,   \r\n            threshold : 50 ,       \r\n            callback : function(data) {\r\n                if( ! data.data) return ;          \r\n                $.each(data.data , (index , esf)=> {\r\n                    esf.url = \"/\"+$(\"#cityPinYin\").val()+\"/esf/\" + esf.encryptHouseId + \".html?storeId=\"+$(\"#storeId\").val() ;\r\n                    $(\".tabs-frame.esf-items .list-container\").append(self.createEsf(esf)) ;\r\n                }) ;\r\n            }\r\n        }) ;\r\n       \r\n    } ;\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n   根据门店id获取经纬度\r\n   -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n   byIdGetPosition(){\r\n       console.log('进入函数');\r\n       this.request(this.apiUrl.store.wxmpStore,{ \"storeId\" : $(\"#storeId\").val() },{\r\n           successCallback(result){\r\n               console.log(JSON.stringify(result))\r\n           }\r\n       })\r\n   }\r\n\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n   定位服务\r\n   -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    getLocation(){\r\n        if( ! navigator.geolocation ) {\r\n            $.tips( \"您的浏览器不支持定位地理位置\" , 3 ) ;\r\n            return ;\r\n        }\r\n        let geoOpts = {\r\n            enableHighAccuracy : false ,\r\n            maximumAge : 0 ,\r\n            timeout : 10 * 1000\r\n        } ;\r\n        let  locationPo={\r\n            latitude:null,\r\n            longitude:null\r\n        };\r\n        console.log('没有进去定位');\r\n        navigator.geolocation.getCurrentPosition( (position) => {\r\n            locationPo.latitude = position.coords.latitude;\r\n            locationPo.longitude = position.coords.longitude;\r\n            console.log('进入定位');\r\n            console.log(locationPo);\r\n        }, ( error ) => {\r\n            switch(error.code) {\r\n                case error.PERMISSION_DENIED :  // 用户阻止了授权\r\n\r\n                    break ;\r\n                case error.POSITION_UNAVAILABLE :  //定位信息无效\r\n                    $.tips( \"定位信息无效\" , 3 ) ;\r\n                    break ;\r\n\r\n                case error.TIMEOUT :  //定位超时\r\n                    $.tips( \"定位超时\" , 3 ) ;\r\n                    break ;\r\n\r\n                case error.UNKNOWN_ERROR :  //其他不可预知的错误\r\n\r\n                    break ;\r\n            }\r\n        } , geoOpts );\r\n        return locationPo\r\n    }\r\n}\r\n/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n类的初始化\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n$(document).ready(function() {\r\n    new IndexController ;\r\n}) ;"]}
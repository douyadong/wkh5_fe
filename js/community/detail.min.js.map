{"version":3,"sources":["community/detail.min.js"],"names":["DetailController","self","$","on","window","history","go","require","Album","PreviewImage","that","encryptsubestateid","attr","request","apiUrl","community","chart","subEstateId","successCallback","data","status","dataRes","echartData","recombineM","echartFun","seriesData","countNum","echartShow","forEach","item","index","push","parseFloat","hide","sortArray","sort","a","b","maxPrice","Math","ceil","length","notZroArray","minPrice","avgPrice","myChart","echarts","init","document","getElementById","width","houseId","subestateid","echartBigData","option","tooltip","trigger","triggerOn","position","backgroundColor","padding","textStyle","color","fontSize","formatter","params","ticket","callback","paramsValue","value","common","bigData","grid","bottom","left","right","containLabel","xAxis","monthList","splitLine","show","axisTick","type","boundaryGap","axisLine","lineStyle","axisLabel","interval","rotate","fontFamily","yAxis","inside","toFixed","min","max","series","name","normal","itemStyle","emphasis","borderColor","borderWidth","symbolSize","connectNulls","setOption","month","date","split","indexOf","charAt","unitPrice","console","log","Controller","ready"],"mappings":"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","file":"detail.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n 1. 项目名称：悟空找房h5\n 2. 页面名称：subestate/detail(小区-详情)\n 3. 作者：tangxuyang@lifang.com\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n class DetailController extends Controller {\n    constructor() {\n        super() ;             \n        let self = this ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        页面顶部的返回按钮\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        $('.icon-back').on('click',function(){\n            window.history.go(-1) ;\n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        相册集图片预览功能\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        require(['../components/album.min','../components/preview-image.min'],function(Album, PreviewImage){\n            PreviewImage('.subestate-comments');\n        }) ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        请求接口 获取折线图参数\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        let that = this;\n        // 获取小区加密Id\n        let  encryptsubestateid = $('#estateName').attr('data-encryptsubestateid');\n        this.request(this.apiUrl.community.chart,{subEstateId:encryptsubestateid},{successCallback(data){\n                if (data.status == 1){\n                    let dataRes = data;\n                    let echartData =  that.recombineM(dataRes.data);\n                    that.echartFun(echartData) ;\n                }\n            }});\n    };\n\n     /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n     折线图函数异步操作\n     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n     echartFun(echartData){\n         let seriesData=[];\n         let countNum = 0;\n         let echartShow = true;\n         echartData.seriesData.forEach(function(item,index){\n             if(item == 0){\n                 seriesData.push(null);\n                 countNum += 1;\n                 if (countNum == 11 && index == 10){\n                     echartShow = false;\n                 }\n             }else{\n                 seriesData.push(parseFloat(item));\n             }\n         });\n         if (!echartShow) {\n             $('#estateNameEcharts').hide();\n             return\n         }\n         let sortArray = echartData.seriesData.sort(function(a, b) {\n             return parseFloat(a) - parseFloat(b);\n         });\n         /* 按照3.12需求文档走势图数据要求*/\n         let maxPrice = Math.ceil((sortArray[sortArray.length - 1] / 1000)) * 1000;\n         let notZroArray = [];\n         sortArray.forEach(function (item,index) {\n             if (item != 0){\n                 notZroArray.push(item)\n             }\n         });\n         let minPrice = Math.ceil((notZroArray[0] / 1000) - 1) * 1000;\n         let avgPrice = 1000 ;\n         if (sortArray[sortArray.length - 1] == notZroArray[0] ) {\n             minPrice = minPrice - 2000;\n             avgPrice = 1000\n         }else{\n             avgPrice = (maxPrice - minPrice)/4 < 1000 ? 1000:Math.ceil((maxPrice - minPrice)/4000)*1000;\n         }\n         minPrice =  minPrice < 0 ? 0:minPrice;\n         let myChart = echarts.init(document.getElementById('main'),{ width: '88%' });\n         let that = this;\n         // 给折线图dome增加埋点\n         let houseId =  $('#estateName').attr('data-houseid');\n         let subestateid =  $('#estateName').attr('data-subestateid') ;\n         let echartBigData = {\n             \"eventName\": \"1067014\",\n             \"eventParam\": { \"house_id\" : houseId , \"estate_id\": subestateid },\n             \"type\": 2\n         };\n         // 指定图表的配置项和数据\n         let option = {\n             tooltip: {      // 提示框\n                 trigger: 'item',\n                 triggerOn: 'click',\n                 position: 'top',\n                 backgroundColor: '#4081D6',\n                 padding: 4,\n                 textStyle: {\n                     color: '#fff',\n                     fontSize: '12'\n                 },\n                 formatter:function (params, ticket, callback) {\n                     let paramsValue =  params.value + \"元\";\n                     that.request(that.apiUrl.common.bigData , echartBigData ,function () {\n\n                     });\n                     return paramsValue;\n                 }\n             },\n             grid: {\n                 bottom: 20,\n                 left: '3%',\n                 right: '10%',\n                 containLabel: true,\n             },\n             xAxis: {\n                 data: echartData.monthList ,  // X坐标数据\n                 splitLine: {show: false}, // 控制网格线是否显示\n                 axisTick: {show: false},  // 去除x轴上的刻度线\n                 position: 'bottom',\n                 type: 'category',\n                 boundaryGap: false,\n                 axisLine: {\n                     lineStyle: {\n                         color: '#979797', // x轴颜色\n                     }\n                 },\n                 axisLabel: {\n                     interval: 0,\n                     rotate: 0, //60度角倾斜显示\n                     textStyle: {\n                         color: '#999',\n                         fontSize: 12,\n                         fontFamily: '微软雅黑'\n                     }\n                 },\n             },\n             yAxis: {\n                 axisLine: {show: false},   // y轴是否显示\n                 splitLine: {\n                     show: true,  // 控制网格线是否显示\n                     lineStyle: {\n                         color: ['#979797'] // y刻度颜色\n                     }\n                 },\n                 axisTick: {show: false},// 去除y轴上的刻度线\n                 axisLabel:{\n                     inside: false,\n                     textStyle: {\n                         color: '#999',\n                     },\n                     formatter: function(value, index) {\n                         if (value == minPrice-avgPrice || value == 0) {\n                             return \"\";\n                         } else {\n                             return (value / 10000).toFixed(1) + ' 万';\n                         }\n                     }\n                 },\n                 min:minPrice-avgPrice > 0 ? minPrice-avgPrice : 0,\n                 max:minPrice-avgPrice > 0 ? minPrice+ avgPrice * 4:avgPrice * 5,\n                 interval:avgPrice,\n             },\n             series: [{\n                 name: '销量',\n                 type: 'line',\n                 lineStyle:{\n                     normal:{\n                         color:'#4081D6', // 折线条颜色\n                     }\n\n                 },\n                 itemStyle:{\n                     normal:{\n                         color: \"#4081D6\", //图标颜色\n                     },\n                     emphasis: { //重点，强调时候的样式，即当鼠标悬停或点击上去的时候的拐点的样式\n                         borderColor: '#4081D6',\n                         borderWidth: 2,\n                         color: '#4081D6'\n                     }\n                 },\n                 symbolSize: 5,\n                 connectNulls: true,\n                 data: seriesData,\n             }],\n         };\n         myChart.setOption(option);\n     };\n     /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n     处理得到的数据的函数  处理月份和数据\n     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n     recombineM(data) {\n         let echartData = {\n             monthList: [],\n             seriesData: []\n         };\n         if (data) {\n             data.forEach((item) => {\n                 let month = item.date.split('-')[1];\n                 if (month.indexOf('0') == 0) {\n                     echartData.monthList.push(month.charAt(1)+'月')\n                 } else {\n                     echartData.monthList.push(month+'月')\n                 }\n                 echartData.seriesData.push(item.unitPrice)\n             });\n         }\n         console.log(echartData);\n         return echartData ;\n     }\n}\n/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n类的初始化\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n$(document).ready(function() {\n    new DetailController;\n}) ;\n"]}
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 1. 项目名称：悟空找房h5
 2. 页面名称：essay -> index(取经频道首页)
 3. 作者：赵华刚@lifang.com
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
class IndexController extends Controller {
    constructor() {
        super() ;
        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
        给文章类别导航菜单容器以及特殊栏目卡片容器计算宽度并赋予样式，实现滚动
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/         
        this.computeScrollWidth() ;
        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
        给dom节点绑定事件
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/ 
        this.addEventListener() ;
    } ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    给文章类别导航菜单容器计算宽度并赋予样式，实现滚动
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    computeScrollWidth() {        
        let categoryWidth = 0 ;       
        $(".essay-category a , .essay-category span").each(function(){            
            categoryWidth += ($(this).width() + 35) ;  //35是什么概念：每个菜单有15px的左右margin，一起就是30，再放5px
        }) ;        
        $(".essay-category div").css({ "width" : categoryWidth + "px" }) ; 
    }
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    给dom节点绑定事件
    1. 文章类别导航菜单中如果是span标签说明有子菜单，就要赋予点击监听
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    addEventListener() {
        $(".essay-category span").click(function(){
            $(".essay-subcategory").hide() ;
            let $subCategoryContainer = $("#essayCategory" + $(this).attr("data-id") + "ChildList") ;
            $subCategoryContainer.slideDown("200" , function(){
                //展开后要再计算二级类别总宽度，再赋予容器
                let subCategoryWidth = 0 ;
                $subCategoryContainer.find("a").each(function(){                    
                    subCategoryWidth += ($(this).width() +40) ;
                }) ;
                $subCategoryContainer.find("div").css({ "width" : subCategoryWidth + "px" }) ;
            }) ;
        }) ;
    }   
}
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
类的初始化
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
$(document).ready(function() {
    new IndexController ;
}) ;
